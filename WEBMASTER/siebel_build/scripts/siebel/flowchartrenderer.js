/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2014
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 8.1.1.14SIA[23044]PATCHSET7 */
if(typeof(SiebelAppFacade.FlowchartRenderer)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.FlowchartRenderer");define("siebel/flowchartrenderer",[],function(){SiebelAppFacade.FlowchartRenderer=(function(){function e(r){SiebelAppFacade.FlowchartRenderer.superclass.constructor.call(this,r)}SiebelJS.Extend(e,SiebelAppFacade.PhysicalRenderer);e.prototype.Init=function(){SiebelAppFacade.FlowchartRenderer.superclass.Init.call(this);this.AttachPMBinding("drawFlowchart",function(){var r=this.GetPM().Get("drawFlowchart");if(r==="full"){j.call(this)}else{n.call(this,"gfcDeltaMap")}},{scope:this});this.AttachPMBinding("menuMarkup",function(){d.call(this)},{scope:this})};function j(){$("#canvas-content").empty();$("#paletteitems").empty();b.call(this);n.call(this,"gfcObjectsMap")}function k(D,B){var t=parseInt(D.data("x1"),10),A=parseInt(D.data("y1"),10),s=parseInt(D.data("x2"),10),z=parseInt(D.data("y2"),10),C=D.data("clr"),y=10,x=5,u=Math.sqrt((s-t)*(s-t)+(z-A)*(z-A));D.css("position","absolute");D.css("top",A+"px");D.css("left",t+"px");D.css("height",u+"px");D.css("background-color",C);if(!($.support.cssFloat)){D.css("top",(z>A)?A+"px":z+"px");D.css("left",t+"px");var v=(s-t)/u;var r=(z-A)/u;D.css("filter","progid:DXImageTransform.Microsoft.Matrix(sizingMethod='auto expand', M11="+v+", M12="+-1*r+", M21="+r+", M22="+v+")")}else{var w=Math.acos((z-A)/u);if(s>t){w*=-1}D.css("WebkitTransformOrigin","top left");D.css("transform","rotate("+w+"rad)");D.css("MozTransform","rotate("+w+"rad)");D.css("WebkitTransform","rotate("+w+"rad)");D.css("OTransform","rotate("+w+"rad)");w+=3.14/2;x=10*Math.sin(w)+5*Math.cos(w);y=10*Math.cos(w)-5*Math.sin(w);B.attr("title","angle: "+w);B.css("top",(z-x)+"px");B.css("left",(s-y)+"px");B.css("WebkitTransformOrigin","top left");B.css("transform","rotate("+w+"rad)");B.css("MozTransform","rotate("+w+"rad)");B.css("WebkitTransform","rotate("+w+"rad)");B.css("OTransform","rotate("+w+"rad)")}return D}function f(s,u,B,t,y,r,x,C){var A=$("<div></div>");var v=parseInt(C,10);if(v){C="rgb("+(v&255)+","+((v&65280)>>8)+","+((v&16711680)>>16)+")"}if(B){$(A).data("toId",B)}$(A).addClass("connector").attr("id",s).data("x1",t).data("y1",y).data("x2",r).data("y2",x).data("clr",C).data("frId",u);var z=$("<div></div>");$(z).addClass("endpoint").attr("id","to-end-"+s).attr("title","left:"+(r-5)+" top:"+(x-5)).css("position","absolute").css("top",(x)+"px").css("left",(r)+"px").css("border-left","20px solid "+C).data("ConId",s);var w=$("<div></div>");$(w).addClass("startpoint").attr("id","from-end-"+s).attr("title","left:"+(t)+" top:"+(y)).css("position","absolute").css("top",(y-5)+"px").css("left",(t-5)+"px").css("background-color",C).data("ConId",s);$("#canvas-content").append(k.call(this,$(A),$(z))).append($(z).draggable()).append($(w).draggable().on("dragstart",{ctx:this},function(D,E){$("#"+u).css("WebkitBorderImage","url(images/loy_fc_border.png) 5 5 5 5 stretch").css("OBorderImage","url(images/loy_fc_border.png) 5 5 5 5 stretch").css("BorderImage","url(images/loy_fc_border.png) 5 5 5 5 stretch")}).on("dragstop",{ctx:this},function(D,E){$("#"+u).css("WebkitBorderImage","").css("OBorderImage","").css("BorderImage","")}))}function p(s,u,B,t,y,r,x,C){var A=$("#canvas-content #"+s);var v=parseInt(C,10);if(v){C="rgb("+(v&255)+","+((v&65280)>>8)+","+((v&16711680)>>16)+")"}if(B){$(A).data("toId",B)}$(A).data("x1",t).data("y1",y).data("x2",r).data("y2",x).data("clr",C).data("frId",u);var z=$("#canvas-content #to-end-"+s);$(z).attr("title","left:"+(r-5)+" top:"+(x-5)).css("position","absolute").css("top",(x)+"px").css("left",(r)+"px").css("border-left","20px solid "+C);var w=$("#canvas-content #from-end-"+s);$(w).attr("title","left:"+t+" top:"+y).css("top",(y-5)+"px").css("left",(t-5)+"px");k.call(this,$(A),$(z)).append($(w))}function c(x,t,r,y,s,z,B,v){var u='<div id="'+r+'"> <img src="'+t+'" width="'+(B-4)+'" height="'+(v-4)+'"/>'+x+"</div>";$(u).find("img").attr("width",(B-4)).attr("height",(v-4));var A=y+":"+s+":"+z+":"+B+":"+v;$("#canvas-content").data(r,A);$("#canvas-content").append($(u).addClass("node").attr("id",r).attr("title",s+" "+z+" "+B+" "+v).attr("tabindex",(1101+$("#canvas-content .node").length)).draggable({containment:"parent"}).css("position","absolute").css("top",z+"px").css("left",s+"px").css("width",B).css("height",v))}function a(y,r,z,s,A,B,x){var u=$("#canvas-content #"+r);var t=u.children();u.empty();u.append(t).append(y);u.attr("title",s+" "+A+" "+B+" "+x);u.find("img").attr("width",(B-4)).attr("height",(x-4));var v=$("#canvas-content").data(r).split(":");v[0]=z;v[1]=s;v[2]=A;v[3]=B;v[4]=x;$("#canvas-content").data(r,v.join(":"));u.css("position","absolute").css("top",A+"px").css("left",s+"px").css("width",B).css("height",x)}function h(r,t){var s;$("#canvas-content .node").each(function(u,x){var z=parseInt($(x).position().left,10);var y=parseInt($(x).position().top,10);var w=parseInt(($(x).width()+z),10);var v=parseInt(($(x).height()+y),10);if(r>=z&&r<=w&&t>=y&&t<=v){s=x}});return s}function o(){$("#FCToolBar #delete").button({text:false,icons:{primary:"ui-icon-closethick"}}).on("click",{ctx:this},function(r){var s=$("#canvas-content .ui-selected.node,.ui-selected.connector").attr("id");r.data.ctx.GetPM().OnControlEvent("eventBtnClick","delete",s);return false});$("#FCToolBar #options").button({text:false,icons:{primary:"ui-icon-gear",secondary:"ui-icon-triangle-1-s"}}).on("click",{ctx:this},function(v){var u;var t;var r=[];var s="#canvas-content .ui-selected.node,.ui-selected.connector";$(s).each(function(y,z){r.push($(z).attr("id"))});var w=r.length;if(w===1){u=r[0];if(u){t=$("#canvas-content").data(u).split(":")[0]}}var x=$("#FCToolBar #menu").show().position({my:"left top",at:"left bottom",of:this});v.data.ctx.GetPM().OnControlEvent("eventMenuSelect",w,t);return false});$("#FCToolBar #menu").menu().hide().on("menuselect",{ctx:this},function(s,u){var t=u.item.attr("id");var r=[];$("#canvas-content .ui-selected.node,.ui-selected.connector").each(function(v,w){r.push($(w).attr("id"))});$("#FCToolBar #menu").hide();s.data.ctx.GetPM().OnControlEvent("eventMenuClick",t,r);return false})}function b(){var s=$("#paletteitems");var t=this.GetPM().Get("paletteItems");var r=t.length;if(r>0){for(var u=0;u<r;u++){s.append(t[u])}$("#paletteitems div").draggable({appendTo:"body",helper:"clone"})}}function n(x){var F=this.GetPM().Get(x);var v;for(var A in F){var w=F[A];if(A==="Selected"){v=w;continue}if(w){if(w.action==="Deleted"){var D=$("#canvas-content").find("#"+w.id);if(D){if(D.hasClass("connector")){var t=$("#canvas-content").find("#to-end-"+w.id);if(t){t.remove()}}D.remove()}continue}if(w.shpId!=="0"&&w.shpId!=="2"){var s=w.r;if(s){var E=s.split(" ");var z=(E[2]-E[0]);var y=(E[3]-E[1]);if($("#"+w.id).length===0){c.call(this,w.txt,w.imgSrc,w.id,w.shpId,E[0],E[1],z,y)}else{a.call(this,w.txt,w.id,w.shpId,E[0],E[1],z,y)}}}else{var C=w.P0.split(" ");var u=w.P1.split(" ");if($("#"+w.id).length===0){f.call(this,w.id,w.FromID,w.ToID,C[0],C[1],u[0],u[1],w.LineColor)
}else{p.call(this,w.id,w.FromID,w.ToID,C[0],C[1],u[0],u[1],w.LineColor)}}}}if(v){var B=this.GetPM().Get("SelectedId");if(v!==""&&v!==B){$("#canvas-content div").removeClass("ui-selected");$("#canvas-content #"+v).addClass("ui-selected");var r=CCFMiscUtil_CreatePropSet();r.SetProperty("sel",v);this.GetPM().ExecuteMethod("NotifyServer","selChanged",r)}}}function d(){var r=this.GetPM().Get("menuMarkup");var u=$("#FCToolBar #menu").empty();u.append(r);var t=this.GetPM().Get("disabledMenuList");if(t!==""){var s=t.split("|");i.call(this,s)}u.menu().show();$(document).one("click",function(){u.hide()})}function i(s){var v=$("#FCToolBar #menu");var t;var u=s.length;for(var r=0;r<u;r++){t=v.find("#"+s[r]);if(t){t.addClass("ui-state-disabled ui-corner-all");t.parent("li").find("ul").remove()}}}function l(s){var r=$("#FCToolBar #menu").find("#"+s);r.removeClass("ui-state-disabled");r.addClass("siebui-appmenu-item ui-menu-item")}function q(){o.call(this);$("#palette").accordion({header:"#paletteHeader",heightStyle:"content"});$("#actionsWindow").accordion({header:"#actionHeader",heightStyle:"content"});$("#canvas-content").selectable({filter:"div",distance:0,stop:function(r,s){}}).droppable({activeClass:"ui-state-default",hoverClass:"ui-state-hover",accept:":not(.ui-sortable-helper)"}).on("drop",{ctx:this},function(r,B){var x=Math.round((r.pageX-$("#canvas-content").offset().left));var s=Math.round((r.pageY-$("#canvas-content").offset().top));var t=B.draggable.eq(0);var y=t.attr("id");var C=t.parent().attr("id");var A=t.data("ConId");var v=h.call(this,x,s);var u="";var z="";if(v){u=$(v).attr("id");z=$(v).attr("title")}var w=$("#canvas-content").data(y);r.data.ctx.GetPM().OnControlEvent("eventDrop",x,s,y,C,A,u,z,w);return false}).on("mouseup",{ctx:this},function(s){var r=s.target;if(!($(r).attr("id"))){r=$(r).parent()}$("#canvas-content div").removeClass("ui-selected");var t=$(r).attr("id");if(t&&t.indexOf("-end-")!==-1){t=$(r).data("ConId")}if(t&&t!=="canvas-content"){$(r).addClass("ui-selected")}s.data.ctx.GetPM().OnControlEvent("eventMouseup",t)}).on("keyup",{ctx:this},function(s){var r=s.target;if(!($(r).attr("id"))){r=$(r).parent()}var t=r.attr("id");s.data.ctx.GetPM().OnControlEvent("eventKeyup",t,s.which,s.ctrlKey,s.shiftKey)}).on("dblclick","div",{ctx:this},function(s){var r=s.target;if(!($(r).attr("id"))){r=$(r).parent()}var t=r.attr("id");s.data.ctx.GetPM().OnControlEvent("eventDblClick",t)})}function m(){var v=this.GetPM();var t=$("#"+v.Get("GetFullId")).parent().width();$("#control").width(t);var w=$("#palette").outerWidth(true),x=$("#palette").width(),u=$("#canvas").outerWidth(true),r=$("#canvas").width(),s=u-r;r=t-w-s;$("#canvas").width(r);$("#FCToolBar").width(x+r)}function g(){var s=0,C=0;var r=$(window).height(),A=$("#control").offset().top;$("#_swecontent").find("table.AppletBackTable").each(function(){s+=$(this).height();C+=$(this).outerHeight(true)});var B=C-s,y=r-(A+B);$("#control").height(y);var v=$("#FCToolBar").outerHeight(true),z=$("#canvas").outerHeight(true),x=$("#canvas").height(),t=z-x;x=y-v-t;$("#canvas").height(x);var w=$("#paletteHeader").outerHeight(true),u=x-w;$("#paletteitems").height(u)}e.prototype.resize=function(){};e.prototype.ShowUI=function(){SiebelAppFacade.FlowchartRenderer.superclass.ShowUI.call(this);q.call(this);var r=CCFMiscUtil_CreatePropSet();this.GetPM().ExecuteMethod("NotifyServer","populate",r)};e.prototype.BindData=function(){SiebelAppFacade.FlowchartRenderer.superclass.BindData.apply(this,arguments)};e.prototype.BindEvents=function(){SiebelAppFacade.FlowchartRenderer.superclass.BindEvents.call(this);$(window).bind("resize.SiebelAppFacade.FlowchartRenderer",{ctx:this},function(r){if(r.target===window){r.data.ctx.resize()}})};e.prototype.EndLife=function(){$(window).unbind("resize.SiebelAppFacade.FlowchartRenderer");SiebelAppFacade.FlowchartRenderer.superclass.EndLife.call(this);$("#canvas-content").empty();$("#paletteitems").empty()};return e}());return"SiebelAppFacade.FlowchartRenderer"})};