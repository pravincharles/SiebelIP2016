/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2014
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 8.1.1.14SIA[23044]PATCHSET8 */
if(typeof(SiebelAppFacade.fsDispatchBoardRenderer)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.fsDispatchBoardRenderer");define("siebel/fsdispatchboardrenderer",["siebel/ganttrenderer"],function(){SiebelAppFacade.fsDispatchBoardRenderer=(function(){var r=SiebelJS.Dependency("SiebelApp.Constants"),c=r.get("SWE_GANTT_ACTIVITY_LABEL"),t=r.get("SWE_GANTT_ACTIVITY_EARLIEST_LATEST_VIOLATION"),u=r.get("SWE_GANTT_LOAD_ACTIVITY_INTO_ABS"),d=r.get("SWE_GANTT_SERVICE_REGION_ID"),e=r.get("SWE_GANTT_DRILLDOWN_CLS"),k=r.get("SWE_GANTT_RENDER_INFO"),x=r.get("SWE_GANTT_ACTIVITY_NO_DAYS_IN_WEEK"),f=r.get("SWE_GANTT_ACTIVITY_WEEK_DAY_START"),j,n=r.get("SWE_GANTT_TIME_SCALE"),o=r.get("SWE_GANTT_STARTMILLIS"),m=$("#Show_Less_Label").html(),g=$("#Show_More_Label").html();function a(){SiebelAppFacade.fsDispatchBoardRenderer.superclass.constructor.apply(this,arguments)}SiebelJS.Extend(a,SiebelAppFacade.GanttRenderer);a.prototype.ShowUI=function(){var y=this.GetPM(),z=this.GetPM().Get(k);z.AppName=SiebelApp.S_App.GetName();l.call(this);h.call(this);SiebelAppFacade.fsDispatchBoardRenderer.superclass.ShowUI.call(this);if($("#s_at_m_1")!="undefined"&&$("#s_at_m_1").parent()!="undefined"&&$("#s_at_m_1").parent().parent()!="undefined"&&$("#s_at_m_1").parent().parent().parent()!="undefined"&&$("#s_at_m_1").parent().parent().parent().prop("tagName").toLowerCase()==="td"){$("#s_at_m_1").parent().parent().parent().attr("class","AppletMenu")}};a.prototype.BindEvents=function(){SiebelAppFacade.fsDispatchBoardRenderer.superclass.BindEvents.call(this);j=this;var E=this,A=E.GetPM(),G,z,H,F,B,C,y,D=0;$("#s_"+this.GetAppletId()+"_div").unbind("dblclick");$("#s_"+A.Get("GetFullId")+"_div").on("mouseup",(".siebui-splitBox3"),{ctx:this},w).on("mousedown",(".siebui-taskBox.Dragpble"),{ctx:this},q).on("dblclick",(".siebui-taskBox.Dragpble"),{ctx:this},p);G=A.Get("GetControls");z=G["Time Scale"];if(z){H=z.GetInputName();$("#s_"+A.Get("GetFullId")+"_div").find("[Name="+H+"]").bind("autocompleteclose",{ctx:this},function(I){D=0;D=D|(1<<1);D=D|(1<<3);D=D|(1<<4);A.SetProperty("PanesToRefresh",D);A.ExecuteMethod("InvokeServer");$("#s_"+A.Get("GetFullId")+"_div").find("#ganttdatePicker").removeClass("siebui-dateInput").addClass("siebui-dateRange").val(A.ExecuteMethod("getDateRange",""))})}$("#db_resize").bind("click",{ctx:this},function(J){if($("#db_resize").hasClass("siebui-showmore")){$("#db_resize").html("");var K='<a href="javascript:void()"><img src="images/btn_less.gif" border="0" space="0" hspace="0" alt="'+m+'"title="'+m+'"></a>';$("#db_resize").append(K);$("#db_resize").attr("class","siebui-link-icon-e siebui-fs-db-common siebui-showless");var I=j.getGanttCtrlHeight();j.setGanttCtrlHeight(parseInt((I*2),10));v()}else{if($("#db_resize").hasClass("siebui-showless")){$("#db_resize").html("");var K='<a href="javascript:void()"><img src="images/btn_more.gif" border="0" space="0" hspace="0" alt="'+g+'"title="'+g+'"></a>';$("#db_resize").append(K);$("#db_resize").attr("class","siebui-link-icon-e siebui-fs-db-common siebui-showmore");var I=j.getGanttCtrlHeight();j.setGanttCtrlHeight(parseInt((I/2),10));v()}}})};function h(){$("#db_resize").html("");var y='<a href="javascript:void()"><img src="images/btn_more.gif" border="0" space="0" hspace="0" alt="'+g+'"title="'+g+'"></a>';$("#db_resize").append(y);$("#db_resize").attr("class","siebui-link-icon-e siebui-fs-db-common siebui-showmore")}function v(){var z=j.GetPM(),A,y=j.getGanttCtrlHeight();A=$("#"+j.GetCustCtrlName()).addClass("siebui-ganttControl");A.css({height:parseInt(y,10)})}function l(){var C=this,z=C.GetPM(),G=$(window).height(),F=$("#_sweappmenu").height(),y=$(".siebui-button-toolbar").height(),A=$("#_swethreadbar").height(),D=$("#_swescrnbar").height(),B=60,E;if(z.Get("DefaultNavCtrl")==="Tree"){D=0}E=G-(F+y+A+D+B);C.setGanttCtrlHeight(parseInt((E/2),10))}a.prototype.BindData=function(){SiebelAppFacade.fsDispatchBoardRenderer.superclass.BindData.call(this);var y=this.GetPM().Get("Schedulerecordset");if(y.length>0){b.call(this,y)}};a.prototype.SetHScrollPos=function(){var B=this.GetPM();if((B.Get(n)=="4")||(B.Get(n)=="512")||(B.Get(n)=="1024")||(B.Get(n)=="2048")||(B.Get(n)=="4096")||(B.Get(n)=="1")||(B.Get(n)=="64")){if(B.Get("EndTime")){var z=new Date(B.Get("StartDate")),D=String(B.Get("StartTime")),y=new Date(B.Get("paddingMiddleDayMillis")),A=B.Get("DayLoc"),C=0;B.ExecuteMethod("setHoursFrom",z,D);C=A[(y).format("MM/dd/yyyy")];C=C*B.Get("MinGanttsize");$(".siebui-splitBox3").scrollLeft(C)}else{SiebelAppFacade.fsDispatchBoardRenderer.superclass.SetHScrollPos.call(this)}}else{SiebelAppFacade.fsDispatchBoardRenderer.superclass.SetHScrollPos.call(this)}};function q(A){var z=A.data.ctx,y=z.GetPM();$(this).draggable({containment:$("#s_"+y.Get("GetFullId")+"_div").find("#UGrid"),zIndex:9999,drag:function(B,C){},start:function(F,G){var C=$(this).closest("div.siebui-gdfRow").attr("taskid"),B=$(this).closest("div.siebui-gdfRow").attr("Id"),D=$(this).attr("taskid"),E=0;console.log("In Drag");$(this).draggable("option","sResId",C);$(this).draggable("option","resindex",B);$(this).draggable("option","dragType",E);$(this).draggable({cursor:"crosshair"});y.SetProperty("InEvent",true);console.log(C,B,D)}})}function p(y){}a.prototype.calcNonContiguousTime=function(C){var A=this.GetPM();if((A.Get(n)=="1")||(A.Get(n)=="64")||(A.Get(n)=="4")||(A.Get(n)=="512")||(A.Get(n)=="1024")||(A.Get(n)=="2048")||(A.Get(n)=="4096")){var B=A.Get("PixelsPerUnit"),E=A.Get("TDays"),F=A.Get("StartTime"),D=A.Get("EndTime"),y=0;var z=new Date(A.Get(o));var G=A.Get("FinalWeekDays");pixels=B*$("#UGrid").width();if(pixels){noOfUnits=parseInt(C/pixels)}for(i=0;i<noOfUnits;){if(G.indexOf(z.getDay())!==-1){i++}y++;z.setDate(z.getDate()+1)}while(G.indexOf(z.getDay())==-1){y++;z.setDate(z.getDate()+1)}timePixels=C%pixels;startDay=A.Get(o)+y*E;if(pixels){startTime=parseInt(A.Get("StartTime")+timePixels/pixels*A.Get("AxisDuration"),10)}startDay=startDay+startTime;return parseInt(startDay,10)}else{return(SiebelAppFacade.fsDispatchBoardRenderer.superclass.calcNonContiguousTime.call(this,C))}};function w(A){var z=A.data.ctx,y=z.GetPM();$("#s_"+y.Get("GetFullId")+"_div").find(".siebui-taskEditUtility").droppable({drop:function(T,R){var F=null,H=$(this).attr("taskId"),C=R.draggable.attr("taskId"),P=$(this).scrollLeft()+T.clientX-$(this).offset().left,K,S,J,U,X,I,D,E,O=0,M,B,V,Q;B=y.Get(t);V=y.Get(u);Q=y.Get(d);M=$(R.draggable).draggable("option","dragType");if(M===0){if(y.Get("EndTime")){F=new Date(z.calcNonContiguousTime(R.position.left))}else{F=new Date(Math.round((R.position.left/y.Get("fx"))+y.Get("startMillis")))}}else{if(y.Get("EndTime")){F=new Date(z.calcNonContiguousTime(P))}else{K=Math.round((P/y.Get("fx"))+y.Get("startMillis"));F=new Date(K)}}S=(parseInt(((F.getMinutes()+7.5)/15),10)*15);F=new Date(F.setMinutes(S,0));J=F.format("MM/dd/yyyy");U=F.format("HH:mm:ss");X=F.format("MM/dd/yyyy HH:mm:ss");I=SiebelApp.S_App.NewPropertySet();y.SetProperty("InEvent",true);var N=[];for(var W in SiebelApp.S_App.GetActiveView().GetAppletMap()){N.push(W)
}if(M===0){console.log("Within Gantt");C=R.draggable.attr("taskId"),D=$(R.draggable).draggable("option","sResId");$(R.draggable).draggable({cursor:"crosshair"});I.SetProperty("DropSrcApplet",N[1])}else{console.log("Applet to Gantt Drag");var G=R.draggable.attr("id");var L=R.draggable.parent().parent().jqGrid("getRowData",G);I.SetProperty("DropSrcApplet",N[0]);C=L.Activity_UID;D=""}I.SetProperty("DropSrcYId",D);I.SetProperty("DropObjId",C);I.SetProperty("DropTrgtYId",H);I.SetProperty("Start Date",J);I.SetProperty("Start Time",U);I.SetProperty("DropTime",X);I.SetProperty("EnableEarlyLatestStartViolation",B);I.SetProperty("LoadActivityIntoABS",V);I.SetProperty("Gantt Chart Service Region Id",Q);I.SetProperty("operation","DragnDrop");O=0;O=O|(1<<1);O=O|(1<<2);O=O|(1<<4);I.SetProperty("PanesToRefresh",O);y.SetProperty("PanesToRefresh",O);console.log("New ",F,C,D,H);y.ExecuteMethod("InvokeOperation",I);if($("body").attr("style")!="undefined"&&$("body").attr("style")==="cursor: crosshair;"){$("body").attr("style","cursor: auto;")}}})}function s(A,B){var z=A.getMinutes(),y;y=(parseInt(((z+B/2)/B),10)*B);A=new Date(A.setMinutes(y,0));return A}a.prototype.preparerowtasks=function(V,G){var T="";var U=this.GetPM(),Y=U.Get("Color Display By"),O=U.Get("Status Abbreviations"),z=U.Get("Booking Colors"),X,Q,C,R,P,D,F,K,Z,L,S,H,N,B,A,E,J;if(O){X=O.substring(O.indexOf(Y)+Y.length+1,O.indexOf(";",O.indexOf(Y)))}if(V){for(S in V){if(V.hasOwnProperty(S)){Q=V[S][X];C=X+"_"+Q;F="BGRCLR_"+V[S]["BGRCLR"];K="BDRCLR_"+V[S]["BDRCLR"];Z="TXTCLR_"+V[S]["LBL"];R=z[C];R=z[F];P=z[K];D=z[Z];if(!R){R=U.Get("EventDefaultColor")}N=V[S]["width"];if(typeof(N)==="undefined"||N==0){continue}B="";A=V[S]["OLPCNT"];if(typeof(P)!="undefined"&&typeof(A)==="undefined"){B="border-color:#"+P+";border-width:2px;"}H=V[S][c];if(!D||!H){D=""}if(!H){H=""}E=V[S]["DDID"];if(!E){E="";J=""}else{J=e}T=T+'<div class="siebui-taskBox '+V[S]["CLS"]+'" taskId="'+V[S]["ID"]+'" id= "'+G.toString()+'" style="width:'+V[S]["width"]+"%;height:"+V[S]["height"]+"px;left:"+V[S]["left"]+"%;margin-top:"+V[S]["top"]+"px;"+B+'"><div class="siebui-layout" style="background-color:#'+R+';"><div class="taskStatus" status="'+V[S]["GS"]+'"><a class="'+J+'" data-drilldown-type= "UGrid" data-drilldown-id="'+E+'" style="color:#'+D+';">'+H+"</a></div></div>";if(V[S]["ACTTT"]!=""&&z.ACTTT_TTD==="Y"){var W=new Date(V[S]["ST"]);var M=new Date(V[S]["ET"]);var y=V[S]["top"]-V[S]["height"]+4;var I=(V[S]["ACTTT"]*6000000)/(M-W);T=T+'<div class="siebui-layout" style="width:'+I+"%;margin-top:"+y+"px;background-color:#"+z.ACTTT_HPC+';"/>'}T=T+"</div>"}}}return T};function b(E){var D="";if(E){for(var A in E){D="";var C="";var B="";for(var z in E[A].EVENTS){var y=""+(parseInt(E[A].EVENTS[z]["height"])-1);D='<div class="siebui-taskBox '+E[A].EVENTS[z]["BCLS"]+'" id="'+E[A].EVENTS[z]["ID"]+'" style="width:'+E[A].EVENTS[z]["width"]+"%;height:"+y+"px;left:"+E[A].EVENTS[z]["left"]+"%;margin-top:"+E[A].EVENTS[z]["top"]+'px;"/>';C=E[A].EVENTS[z]["Zyid"];B='div[taskid="'+C+'"]';$(B).children(".siebui-eventContainer").append(D);$("#"+E[A].EVENTS[z]["ID"]).bind("click",{ctx:this},function(F){$(this).parent().click()})}}}}return a}());return"SiebelAppFacade.fsDispatchBoardRenderer"})};