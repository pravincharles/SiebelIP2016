/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2014
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 8.1.1.14SIA[23044]PATCHSET9 */
if(typeof(SiebelApp.commitpartconsumed)==="undefined"){SiebelJS.Namespace("SiebelApp.commitpartconsumed");define("siebel/offline/servicecmtparts",["siebel/offline/model"],function(){var b={};var a=SiebelApp.Offlineconstants;b[a.get("DOUIREG_OBJ_NAME")]="SHCE Service FS Activity Part Movements List Applet - Mobile";b[a.get("DOUIREG_OBJ_TYPE")]=a.get("DOUIREG_OBJ_TYPEAPPLET");b[a.get("DOUIREG_OBJ_MTHD")]="DoCanInvokeMethod";b[a.get("DOUIREG_SRVC_NAME")]="commitpartconsumed";b[a.get("DOUIREG_SRVC_MTDH")]="DoCanInvokeMethod";b[a.get("DOUIREG_EXT_TYPE")]=a.get("DOUIREG_EXT_TYPEPRE");SiebelApp.S_App.Model.ServiceRegistry(b);b={};b[a.get("DOUIREG_OBJ_NAME")]="SHCE Service FS Activity Part Movements List Applet - Mobile";b[a.get("DOUIREG_OBJ_TYPE")]=a.get("DOUIREG_OBJ_TYPEAPPLET");b[a.get("DOUIREG_OBJ_MTHD")]="DoInvokeMethod";b[a.get("DOUIREG_SRVC_NAME")]="commitpartconsumed";b[a.get("DOUIREG_SRVC_MTDH")]="DoInvokeMethod";b[a.get("DOUIREG_EXT_TYPE")]=a.get("DOUIREG_EXT_TYPEPRE");SiebelApp.S_App.Model.ServiceRegistry(b);b[a.get("DOUIREG_OBJ_NAME")]="SHCE Service FS Activity Part Movements List Applet - Mobile";b[a.get("DOUIREG_OBJ_TYPE")]=a.get("DOUIREG_OBJ_TYPEAPPLET");b[a.get("DOUIREG_OBJ_MTHD")]="CanUpdate";b[a.get("DOUIREG_SRVC_NAME")]="commitpartconsumed";b[a.get("DOUIREG_SRVC_MTDH")]="CanUpdate";b[a.get("DOUIREG_EXT_TYPE")]=a.get("DOUIREG_EXT_TYPEPRE");SiebelApp.S_App.Model.ServiceRegistry(b);SiebelApp.commitpartconsumed=(function(){function c(d){}SiebelJS.Extend(c,SiebelApp.ServiceModel);c.prototype.DoCanInvokeMethod=function(f){var e=CCFMiscUtil_CreatePropSet();var g="";g=f.GetProperty("MethodName").toString();if(g==="CommitPartMvmtClient"){e.SetProperty("Invoked",true);e.SetProperty("RetVal",true);$.setReturnValue({err:false,retVal:e})}else{if(g==="EditRecord"){var d;currentApplet=this.GetContext();currentBC=currentApplet.GetBusComp();d=currentBC.FieldValue("Commit Txn Flag");$.callback(this,function(h){d=h.retVal;if((!currentBC.CheckActiveRow())||(d==="Y")){e.SetProperty("Invoked",true);e.SetProperty("RetVal",false);$.setReturnValue({err:false,retVal:e})}else{e.SetProperty("Invoked",true);e.SetProperty("RetVal",true);$.setReturnValue({err:false,retVal:e})}})}else{if(g==="OrderPartsRMA"){e.SetProperty("Invoked",true);e.SetProperty("RetVal",true);$.setReturnValue({err:false,retVal:e})}else{if(g==="OrderPartsRMARepairs"){e.SetProperty("Invoked",true);e.SetProperty("RetVal",true);$.setReturnValue({err:false,retVal:e})}else{e.SetProperty("Invoked",false);e.SetProperty("RetVal",false);$.setReturnValue({err:false,retVal:e})}}}}};c.prototype.DoInvokeMethod=function(e){var f="";var d=CCFMiscUtil_CreatePropSet();f=e.GetProperty("MethodName").toString();if(f==="CommitPartMvmtClient"){this.CommitPartMvmtClient();$.callback(this,function(g){d.SetProperty("Invoked",true);$.setReturnValue({err:false,retVal:d})})}else{if(f==="OrderPartsRMA"){this.createRMAOrder("RMA Return");$.callback(this,function(g){if(g.err){d.SetProperty("Invoked",true);$.setReturnValue({err:g.err,retVal:d});return}d.SetProperty("Invoked",true);$.setReturnValue({err:false,retVal:d})})}else{if(f==="OrderPartsRMARepairs"){this.createRMAOrder("RMA Repair Return");$.callback(this,function(g){if(g.err){d.SetProperty("Invoked",true);$.setReturnValue({err:g.err,retVal:d});return}d.SetProperty("Invoked",true);$.setReturnValue({err:false,retVal:d})})}else{d.SetProperty("Invoked",false);$.setReturnValue({err:false,retVal:d})}}}};c.prototype.CommitPartMvmtClient=function(){SiebelJS.Log("Invoked CommitPartMvmtClient Method..");var g;var f;var h;h=SiebelApp.S_App.Model;g=SiebelApp.S_App.GetActiveView().GetActiveApplet().GetBusComp();g.FieldValue("Commit Txn Flag");var d,e;h=SiebelApp.S_App.Model;e=SiebelApp.S_App.Model.GetBusObj("FS Part Browser").GetBusComp("FS Bucket Header - Part browser");d=SiebelApp.S_App.Model.GetBusObj("FS Part Browser").GetBusComp("FS Bucket - Part Browser");$.callback(this,function(i){f=i.retVal;if(f==="Y"){SiebelJS.Log("Consumed Part Is Already In Committed State")}else{g.FieldValue("Product Id");$.callback(this,function(j){prdId=j.retVal;g.SetFieldValue("Commit Txn Flag","Y",true);$.callback(this,function(k){g.SetCommitPending(true);g.WriteRecord();$.callback(this,function(l){e.SetFldSearchSpec("Product ID",prdId);e.Execute();$.callback(this,function(m){e.Home();$.callback(this,function(n){d.SetFldSearchSpec("Product Id",prdId);d.Execute();$.callback(this,function(o){d.Home();$.callback(this,function(p){if(d.CheckActiveRow()===true){$.callback(this,function(q){d.FieldValue("Quantity");$.callback(this,function(r){quantity=r.retVal;quantity=quantity-1;d.SetFieldValue("Quantity",quantity,true);$.callback(this,function(s){d.SetCommitPending(true);d.WriteRecord();$.callback(this,function(t){SiebelApp.OfflineAppMgr.PostActions(a.get("ACTION_RPC_COMPLETED"))})})})})}})})})})})})})}})};c.prototype.createRMAOrder=function(k){var i;var o;var p;var r;var w;var s;var h;var d;var q;var n;var e;var g;var j;var v;var t;var l;var f;var m;var u=[];e=SiebelApp.S_App.Model;g=SiebelApp.S_App.GetActiveView().GetActiveApplet().GetBusComp();g.FieldValue("Order Item Id");$.callback(this,function(x){i=x.retVal;if(utils.IsEmpty(i)){g.FieldValue("Product Id");$.callback(this,function(y){h=y.retVal;g.FieldValue("Product Name");$.callback(this,function(z){d=z.retVal;g.FieldValue("Used Quantity");$.callback(this,function(A){q=A.retVal;g.FieldValue("Id");$.callback(this,function(B){n=B.retVal;g.FieldValue("Status");$.callback(this,function(C){s=C.retVal;g.FieldValue("Asset Number");$.callback(this,function(D){r=D.retVal;g.FieldValue("Part Number");$.callback(this,function(E){w=E.retVal;j=SiebelApp.S_App.GetActiveView().GetActiveApplet().GetBusComp().GetParentBuscomp();j.FieldValue("Activity SR Id");$.callback(this,function(F){v=F.retVal});j.FieldValue("SR Number");$.callback(this,function(F){t=F.retVal});if(v==""){SiebelApp.OfflineAppMgr.PostActions("ActionRPCCompleted","createRMAOrder");SiebelApp.S_App.OfflineErrorObject.SetErrorMsg("IDS_ERR_FS_MISSING_SR",u);$.setReturnValue({err:"IDS_ERR_FS_MISSING_SR",retVal:""});return}else{e=SiebelApp.S_App.Model;l=SiebelApp.S_App.Model.GetBusObj("Service Request").GetBusComp("Service Request");f=SiebelApp.S_App.Model.GetBusObj("Service Request").GetBusComp("Order Entry - Orders");m=SiebelApp.S_App.Model.GetBusObj("Service Request").GetBusComp("Order Entry - Line Items");f.Execute();$.callback(this,function(F){f.NewRecord(true);$.callback(this,function(G){sLocaleVal=SiebelApp.S_App.Model.GetLovNameVal(k,"FS_ORDER_TYPE");f.GetPickList("Order Type");$.callback(this,function(I){var H=I.retVal;H.SetFldSearchSpec("Order Type",sLocaleVal);$.callback(this,function(J){H.Execute();$.callback(this,function(K){H.Home();$.callback(this,function(L){if(H.CheckActiveRow()===true){H.PickCurrentRow();$.callback(this,function(M){f.SetFieldValue("Service Request Id",v,true);$.callback(this,function(N){f.SetFieldValue("Service Request Number",t,true);$.callback(this,function(O){f.SetCommitPending(true);f.WriteRecord();
$.callback(this,function(P){SiebelApp.OfflineAppMgr.PostActions(a.get("ACTION_RPC_COMPLETED"));f.FieldValue("Order Number");$.callback(this,function(Q){o=Q.retVal;f.FieldValue("Id");$.callback(this,function(R){m_sOrderHeaderId=R.retVal;m.Execute();$.callback(this,function(S){m.NewRecord(true);$.callback(this,function(T){m.SetFieldValue("Product Id",h,true);$.callback(this,function(U){m.SetFieldValue("Product",d,true);$.callback(this,function(V){m.SetFieldValue("Quantity Requested",q,true);$.callback(this,function(W){if(!utils.IsEmpty(r)){m.SetFieldValue("Asset Number",r,true);$.callback(this,function(X){})}if(!utils.IsEmpty(w)){m.SetFieldValue("Part Number",w,true);$.callback(this,function(X){})}if(!utils.IsEmpty(s)){m.SetFieldValue("Product Status Code",s,true);$.callback(this,function(X){})}m.FieldValue("Id");$.callback(this,function(X){sOrderItemId=X.retVal;m.SetFieldValue("Order Header Id",m_sOrderHeaderId,true);$.callback(this,function(Y){m.SetCommitPending(true);m.WriteRecord();$.callback(this,function(Z){g.SetFieldValue("Order Item Id",sOrderItemId,true);$.callback(this,function(aa){g.SetFieldValue("Order Id",m_sOrderHeaderId,true);$.callback(this,function(ab){g.SetFieldValue("Order Number Calc",o,true);$.callback(this,function(ac){g.SetCommitPending(true);g.WriteRecord();$.callback(this,function(ad){SiebelApp.OfflineAppMgr.PostActions(a.get("ACTION_RPC_COMPLETED"))})})})})})})})})})})})})})})})})})})}})})})})})})}})})})})})})})}else{SiebelApp.OfflineAppMgr.PostActions("ActionRPCCompleted","createRMAOrder")}})};c.prototype.CanUpdate=function(i){var g=CCFMiscUtil_CreatePropSet();var h="";var f=this.GetContext().GetBusComp();var d;var e;if(f.CheckActiveRow()){f.FieldValue("Commit Txn Flag");$.callback(this,function(j){e=j.retVal;if(e==="Y"){h=i.GetPropertyAsStr("Field");d=i.GetProperty("Field");if(!utils.IsEmpty(d)&&this.GetContext().GetControls()[h]){if(this.GetContext().GetControls()[h].GetFieldName()){g.SetProperty("Invoked",true);g.SetProperty("RetVal",false);$.setReturnValue({err:false,retVal:g})}else{g.SetProperty("Invoked",false);g.SetProperty("RetVal",false);$.setReturnValue({err:"",retVal:g})}}}})}};return c}());return"SiebelAppFacade.SiebelApp.commitpartconsumed"})};