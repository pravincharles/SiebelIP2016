/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2014
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 8.1.1.14SIA[23044]PATCHSET7 */
if(typeof(SiebelApp.calendarsvc)==="undefined"){SiebelJS.Namespace("SiebelApp.calendarsvc");define("siebel/offline/calendarsvc",["siebel/offline/model","siebel/offline/servicemodel"],function(){var i=SiebelApp.Offlineconstants;var f=SiebelApp.OfflineUtils;var d={};var g="";var a="";var c="";var b="";var h="";var e;d[i.get("DOUIREG_OBJ_NAME")]="";d[i.get("DOUIREG_OBJ_TYPE")]=i.get("DOUIREG_OBJ_TYPEAPPLET");d[i.get("DOUIREG_OBJ_MTHD")]="DoInvokeMethod";d[i.get("DOUIREG_SRVC_NAME")]="calendarsvc";d[i.get("DOUIREG_SRVC_MTDH")]="DoInvokeMethod";d[i.get("DOUIREG_EXT_TYPE")]=i.get("DOUIREG_EXT_TYPEPRE");SiebelApp.S_App.Model.ServiceRegistry(d);d[i.get("DOUIREG_OBJ_NAME")]="";d[i.get("DOUIREG_OBJ_TYPE")]=i.get("DOUIREG_OBJ_TYPEAPPLET");d[i.get("DOUIREG_OBJ_MTHD")]="DoCanInvokeMethod";d[i.get("DOUIREG_SRVC_NAME")]="calendarsvc";d[i.get("DOUIREG_SRVC_MTDH")]="DoCanInvokeMethod";d[i.get("DOUIREG_EXT_TYPE")]=i.get("DOUIREG_EXT_TYPEPRE");SiebelApp.S_App.Model.ServiceRegistry(d);SiebelApp.calendarsvc=(function(){var j=SiebelJS.Dependency("SiebelApp.Utils");function l(n){}SiebelJS.Extend(l,SiebelApp.ServiceModel);l.prototype.Populate=function(){};l.prototype.DoCanInvokeMethod=function(p){var q="";var o=CCFMiscUtil_CreatePropSet();var n;q=p.GetProperty("MethodName").toString();if(q==="GetCalendarDataDM"){o.SetProperty("Invoked",true);o.SetProperty("RetVal",true);$.setReturnValue({err:false,retVal:o})}else{if(q==="CalDrillDownDM"){o.SetProperty("Invoked",true);o.SetProperty("RetVal",true);$.setReturnValue({err:false,retVal:o})}else{if(q==="CalDragdropDM"){o.SetProperty("Invoked",true);o.SetProperty("RetVal",true);$.setReturnValue({err:false,retVal:o})}else{if(q==="CalUpdateEventDM"){o.SetProperty("Invoked",true);o.SetProperty("RetVal",true);$.setReturnValue({err:false,retVal:o})}else{if(q==="CalNewLSCallDM"){o.SetProperty("Invoked",true);o.SetProperty("RetVal",true);$.setReturnValue({err:false,retVal:o})}else{o.SetProperty("Invoked",false);o.SetProperty("RetVal",false);$.setReturnValue({err:false,retVal:o})}}}}}};l.prototype.DoInvokeMethod=function(q){var r="";var o=CCFMiscUtil_CreatePropSet();r=q.GetProperty("MethodName").toString();var n="";if(r==="SetDDContext"){var s=q.GetProperty("rowid").toString();var p=this.GetContext().BusComp();p.SetFldSearchSpec("Id",s);p.Execute();$.callback(this,function(t){p.Home();$.callback(this,function(u){o.SetProperty("Invoked",true);$.setReturnValue({err:false,retVal:o})})})}else{if(r==="GetCalendarDataDM"){n=this.GetInputPS(q);this.CalGetAllCalls(n);$.callback(this,function(t){o.SetProperty("Invoked",true);$.setReturnValue({err:false,retVal:o})})}else{if(r==="CalDrillDownDM"){n=this.GetInputPS(q);this.CalDrillDown(n);$.callback(this,function(t){o.SetProperty("Invoked",true);$.setReturnValue({err:false,retVal:o})})}else{if(r==="CalUpdateEventDM"){n=this.GetInputPS(q);this.CalUpdateEvent(n);$.callback(this,function(t){o.SetProperty("Invoked",true);$.setReturnValue({err:false,retVal:o})})}else{if(r==="CalDragdropDM"){n=this.GetInputPS(q);this.CalDragdrop(n);$.callback(this,function(t){o.SetProperty("Invoked",true);$.setReturnValue({err:false,retVal:o})})}else{if(r==="CalNewLSCallDM"){n=this.GetInputPS(q);this.CalNewLSCall(n);$.callback(this,function(t){o.SetProperty("Invoked",true);$.setReturnValue({err:false,retVal:o})})}else{o.SetProperty("Invoked",false);$.setReturnValue({err:false,retVal:o})}}}}}}};l.prototype.GetInputPS=function(r){var q=CCFMiscUtil_CreatePropSet();var w=r.GetProperty("Request");w=w.replace(/%2f/g,"/");w=w.replace(/%23/g,"#");w=w.replace(/%3a/g,":");w=w.replace(/%7c/g,"|");var p=w.search("start.swe?");var u=w.slice(p+10);var o=u.split("&");var t,v,x;for(var s=0;s<o.length;++s){t=o[s];p=t.search("=");v="";x="";v=t.slice(0,p);x=t.slice(p+1);q.SetProperty(v,x)}return q};function m(q,s,r){if(j.IsEmpty(q)||j.IsEmpty(s)||j.IsEmpty(r)){return false}var p=new Date(q);var o=new Date(s);var n=new Date(r);if(p===null||o===null||n===null){return false}if((n.getTime()>=p.getTime())&&(n.getTime()<=o.getTime())){return true}return false}l.prototype.CalGetAllCalls=function(E){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"Invoked calendarsvc CalGetAllCalls Method","SiebelApp.calendarsvc","CalGetAllCalls"]);var q;var n;var X;var ad;var U;var L;var D;var ab;var T;var Y;var R;var C=CCFMiscUtil_CreatePropSet();var K=CCFMiscUtil_CreatePropSet();var af=this.GetContext().BusObj().GetName();var A=this.GetContext().BusComp().GetName();if(j.IsEmpty(af)||j.IsEmpty(A)){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"CalGetAllCalls Unable to get Start BO/BC names","SiebelApp.calendarsvc","CalGetAllCalls"]);return}var ae=this.GetContext().GetBusComp();var w=SiebelApp.S_App.Model.GetBusObj(af);var S=w.GetBusComp(A);var r=false;var x=this.GetContext().GetUserProperty("Icon Field");var V=this.GetContext().GetUserProperty("Drilldown Object Name");var y=this.GetContext().GetDrillDown(V);var B=y.srcFieldName;var N=E.GetProperty("StartDate");var H=E.GetProperty("EndDate");var ag=[];var s="";var z="Id";var ah="";var M="";var Q="";var P="";var v=this.GetContext().GetUserProperty("Can Update Check Field");if(j.IsEmpty(v)||typeof(v)!=="undefined"){v="Start Date"}v.trim();K.SetProperty("Id","");s=this.GetContext().GetUserProperty("Start Date Field");if(j.IsEmpty(s)||typeof(s)==="undefined"){s="Planned"}s.trim();Q=s;z+=","+s;K.SetProperty(s,"");s=this.GetContext().GetUserProperty("End Date Field");if(j.IsEmpty(s)||typeof(s)==="undefined"){s="Planned Completion"}s.trim();P=s;z+=","+s;K.SetProperty(s,"");s=this.GetContext().GetUserProperty("Display Fields");var aa,W;if(j.IsEmpty(s)||typeof(s)==="undefined"){K.SetProperty("Call Status","");K.SetProperty("Type","");K.SetProperty("Category","");K.SetProperty("Contact Full Name","");K.SetProperty("Account Name","");z+=",Call Status,Type,Category,Contact Full Name,Account Name"}else{var u=s.split(",");aa=0;var I=u.length;while(aa<I){var F=u[aa].trim();s=this.GetContext().GetUserProperty(F+".Tooltip Fields");K.SetProperty(F,"");if(aa===0){ah=s;M=F}if(j.IsEmpty(s)||typeof(s)!=="undefined"){var ac=s.split(",");var Z=0;var o=ac.length;while(Z<o){s=ac[Z].trim();if((s==="Status")&&typeof(S.GetFieldMap()[s])==="undefined"){s="Call Status";r=true}z+=","+s;K.SetProperty(s,"");Z++}}aa++}}if(!j.IsEmpty(x)){K.SetProperty(x,"")}if(!j.IsEmpty(B)){K.SetProperty(B,"")}S.ActivateMultipleFields(K);var O=SiebelApp.S_App.GetActiveView();var G=O.GetApplet(j.UrlDecode(E.GetProperty("SWEActiveApplet")));var p=G.GetDefn().searchSpec;var t=G.GetBusComp().GetName();if(typeof(p)==="undefined"){var J=O.GetActiveApplet();p=J.GetDefn().searchSpec;t=J.GetBusComp().GetName()}if(p&&S.GetName()===t){S.SetAppletSearchSpec(p)}S.Execute();$.callback(this,function(ai){S.Home();$.callback(this,function(ak){var aj=function(){var al=CCFMiscUtil_CreatePropSet();S.GetMultipleFieldValues(K,al);$.callback(this,function(am){al.SetProperty("Buscomp",A);if(m(N,H,al.GetProperty(Q))){S.CanUpdateX(false,v);$.callback(this,function(an){if(an.retVal){al.SetProperty("ReadOnly","N")}else{al.SetProperty("ReadOnly","Y")
}if(!j.IsEmpty(x)){al.SetProperty("ICON_FIELD_DM",al.GetProperty(x))}if(!j.IsEmpty(B)){al.SetProperty("DD_FIELD_VAL_DM",al.GetProperty(B))}if(!j.IsEmpty(ah)){al.SetProperty("TOOL_TIP_FIELDS_DM",ah);al.SetProperty("TOOL_DESC_DM",M)}if(r){al.SetProperty("Status",al.GetProperty("Call Status"))}if(Q!=="Planned"){al.SetProperty("Planned",al.GetProperty(Q))}if(P!=="PlannedCompletion"){al.SetProperty("PlannedCompletion",al.GetProperty(P))}al.SetProperty("FIELD_LIST_DM",z);C.AddChild(al)})}S.NextRecord();$.callback(this,function(ap){var ao=ap.err;if(!ao){aj.call(this)}else{C.SetType("OUICalendarData");var aq=C.EncodeAsString();var an=[];an.push(aq);if(!(ae.IsNotifyEnabled())){ae.EnableNotify();ae.NotifyGeneric("HICalendarData",an);ae.DisableNotify()}else{ae.NotifyGeneric("HICalendarData",an)}SiebelApp.OfflineAppMgr.PostActions("ActionRPCCompleted")}})})};if(S.CheckActiveRow()===true){aj.call(this)}})})};l.prototype.CalDrillDown=function(t){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"Invoked CalDrillDown Method","SiebelApp.calendarsvc","CalDrillDown"]);var A=t.GetProperty("Data");var u=t.GetProperty("CurrentDate");var r=t.GetProperty("SelectedDate");var p=A.split("#");var o=p[1];var n=p[2];n=n.slice(0,Number(o));var w=this.GetContext().GetUserProperty("Drilldown Object Name");var y=this.GetContext().GetDrillDown(w);if(j.IsEmpty(y)){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"CalDrillDown Drilldown definition is empty","SiebelApp.calendarsvc","CalDrillDown"]);return}var q=y.viewname;if(j.IsEmpty(q)){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"CalDrillDown Drilldown view is empty","SiebelApp.calendarsvc","CalDrillDown"]);return}var v=SiebelApp.S_App.Model.GetViewDef(q);if(v){var x=v.BOName;var z=SiebelApp.S_App.Model.GetBusObj(x);var s=z.GetBusComp(y.busCompName);s.SetFldSearchSpec(y.destFieldName,n);SiebelApp.OfflineAppMgr.BuildViewAsync(q,"BS_DRILLDOWN",y,z)}};l.prototype.CalUpdateEvent=function(x){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"Invoked CalUpdateEvent Method","SiebelApp.calendarsvc","CalUpdateEvent"]);var w=x.GetProperty("RowId");var q=x.GetProperty("NewStartDate");var D=x.GetProperty("NewEndDate");var y=x.GetProperty("Optional");if((q===null)||(q==="")){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEvent Start Date is Empty","SiebelApp.calendarsvc","CalUpdateEvent"]);return}q=q.replace("+"," ");if((D===null)||(D==="")){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEvent End Date is Empty","SiebelApp.calendarsvc","CalUpdateEvent"]);return}D=D.replace("+"," ");var r=new Date(q);var v=new Date(D);if(r===null||v===null){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEvent Incorrect format Start Date / End Date","SiebelApp.calendarsvc","CalUpdateEvent"]);return}var E=(v.getTime()-r.getTime())/1000/60;var u=E.toString();var A=this.GetContext().GetUserProperty("Start Date Field");var p=this.GetContext().GetUserProperty("End Date Field");if(j.IsEmpty(A)||j.IsEmpty(p)){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEvent Unable to get Start Date Field/End Date Field","SiebelApp.calendarsvc","CalUpdateEvent"]);return}var o=this.GetContext().GetUserProperty("LS Start Date Field");if(j.IsEmpty(o)){o="Start Date"}var n=this.GetContext().GetUserProperty("LS Duration Minutes Field");if(j.IsEmpty(n)){n="Duration Minutes"}var s=this.GetContext().BusObj().GetName();var C=this.GetContext().BusComp().GetName();if(j.IsEmpty(s)||j.IsEmpty(C)){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"CalUpdateEvent Unable to get Start BO/BC names","SiebelApp.calendarsvc","CalUpdateEvent"]);return}var B=SiebelApp.S_App.Model.GetBusObj(s);var F=B.GetBusComp(C);var t=CCFMiscUtil_CreatePropSet();var z=CCFMiscUtil_CreatePropSet();t.SetProperty(A,"");t.SetProperty(p,"");F.ActivateMultipleFields(t);F.SetFldSearchSpec("Id",w);F.Execute();$.callback(this,function(G){F.Home();$.callback(this,function(H){z.SetProperty(A,q);z.SetProperty(p,D);F.SetMultipleFieldValues(z);$.callback(this,function(I){F.SetCommitPending(true);F.WriteRecord();$.callback(this,function(J){F.SetFldSearchSpec("Id","");SiebelApp.OfflineAppMgr.PostActions("ActionRPCCompleted")})})})})};l.prototype.CalDragdrop=function(B){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"Invoked CalDragdrop Method","SiebelApp.calendarsvc","CalDragdrop"]);var x=B.GetProperty("MethodName");var H=j.UrlDecode(B.GetProperty("StartDate"));var t=B.GetProperty("Data");var C=B.GetProperty("Optional");var s="";var z="";var J="";if(t!==""&&t.indexOf("|")!==-1){J=t.split("|");if(J.length===2){s=j.UrlDecode(J[0]);z=j.UrlDecode(J[1])}else{f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"Invalid strData: "+t,"SiebelApp.calendarsvc","CalDragdrop"]);return}}else{f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"Invalid strData: "+t,"SiebelApp.calendarsvc","CalDragdrop"]);return}var G=this.GetContext().GetBusComp();var D=SiebelApp.S_App.GetActiveView().GetActiveApplet().BusObj();var p=SiebelApp.S_App.GetActiveView().GetAppletMap()[s];var y=D.GetBusCompByName(p.GetBusComp().GetName());var A=[];var r=true;var F=0;var q=CCFMiscUtil_CreatePropSet();var o=CCFMiscUtil_CreatePropSet();var v=CCFMiscUtil_CreatePropSet();var u=CCFMiscUtil_CreatePropSet();while(r){var L="Calendar Drag Field"+(F+1);var K=p.GetUserProperty(L);if(typeof(K)==="undefined"||K===""){r=false}else{J=K.split(",");if(J.length===2){q.SetProperty(J[0].trim(),"");v.SetProperty(J[0].trim(),J[1].trim())}F++}}var E=this.GetContext().GetUserProperty("Start Date Field");var n=this.GetContext().GetUserProperty("End Date Field");o.SetProperty(E,H);var I=z.split(",");var w=I.length;y.ActivateMultipleFields(q);y.Execute();$.callback(this,function(M){y.Home();$.callback(this,function(O){if(O.err){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"Home for srcBuscomp failed.","SiebelApp.calendarsvc","CalDragdrop"]);$.setReturnValue(O);return}var N=function(P){y.PositionById(P);$.callback(this,function(Q){if(Q.err){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"PositionById for: "+P+" failed.","SiebelApp.calendarsvc","CalDragdrop"]);$.setReturnValue(Q);return}u.Reset();y.GetMultipleFieldValues(q,u);$.callback(this,function(R){if(R.err){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"GetMultipleFieldValues for rowID: "+P+" failed.","SiebelApp.calendarsvc","CalDragdrop"]);$.setReturnValue(R);return}k(u,v,o);G.SetExecuted(true);G.NewRecord(true);$.callback(this,function(S){if(S.err){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"New record Failed.","SiebelApp.calendarsvc","CalDragdrop"]);$.setReturnValue(S);return}G.SetMultipleFieldValues(o);$.callback(this,function(T){if(T.err){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"SetMultipleFieldValues Failed","SiebelApp.calendarsvc","CalDragdrop"]);$.setReturnValue(T);return}G.SetCommitPending(true);G.WriteRecord();$.callback(this,function(U){if(U.err){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"BC write Failed.","SiebelApp.calendarsvc","CalDragdrop"]);$.setReturnValue(U);return}F++;if(F<w){N.call(this,I[F].trim())}else{SiebelApp.OfflineAppMgr.PostActions("ActionRPCCompleted")}})})})})})};F=0;N.call(this,I[F].trim())
})})};function k(r,n,o){var q;for(var p=true;(q=n.EnumProperties(p))!==null;p=false){o.SetProperty(n.GetProperty(q),r.GetProperty(q))}}l.prototype.CalNewLSCall=function(p){f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),"Invoked CalNewLSCall Method (NI)","SiebelApp.calendarsvc","CalNewLSCall"]);var o=p.GetProperty("MethodName");var r=p.GetProperty("StartDate");var q=p.GetProperty("CurrentDateTime");var n="calendarsvc.prototype.CalNewLSCall\n";n+="MethodName: "+o+"\n";n+="StartDate: "+r+"\n";n+="CurrentDateTime: "+q+"\n";f.CcfLogEvent([i.get("LOG_EVT_CLIENT_SYS"),n,"SiebelApp.calendarsvc","CalNewLSCall"])};return l}());return"SiebelAppFacade.calendarsvc"})};