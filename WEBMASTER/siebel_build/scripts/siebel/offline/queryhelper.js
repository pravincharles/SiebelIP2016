/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2014
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 8.1.1.14SIA[23044]PATCHSET7 */
if(typeof(SiebelApp.QueryHelper)==="undefined"){Namespace("SiebelApp.QueryHelper");SiebelApp.QueryHelper=(function(){var e;var h=SiebelApp.Utils;var d=function(){var j;d=function(){return j};d.prototype=this;j=new d();j.constructor=d;return j};e=new d();var b;var g;var c;d.prototype.SetContext=function(j,k,l){b=j;g=k;c=l};d.prototype.GetContext=function(j){return b};d.prototype.GetValue=function(j){return g};d.prototype.DeleteContext=function(){b=""};d.prototype.RemoveContext=function(j){if(j===b){b=null}};d.prototype.EvaluateConstantNode=function(l){var m=l.value.replace(/^["'](.*)["']$/,"$1"),j=/^["']+/,n=m.match(j);if(n){var k=new RegExp(n[0]+"$");m=m.replace(k,"").replace(j,"")}return m};d.prototype.EvaluateConstantFunctionNode=function(j){var k="";switch(j.value.toUpperCase()){case"PARENTBCNAME":var l=SiebelApp.QueryHelper.GetContext();if(l){k=l.GetParentBusComp()?l.GetParentBusComp().GetName():""}break;case"TIMESTAMP":k=SiebelApp.OfflineUtils.GetTS();break;case"TODAY":k=new SiebelApp.S_App.DatumUTCDateTimeObject();k.SetToNow();break;case"LANGUAGE":k=SiebelApp.S_App.Model.GetLanguage();break;case"POSITIONID":k=SiebelApp.S_App.Model.GetPositionId();break;case"LOGINID":k=SiebelApp.S_App.Model.GetLoginId();break;case"LOGINNAME":k=SiebelApp.S_App.Model.GetLoginName();break}return k};d.prototype.EvaluateIdentifierNode=function(j){return j.value};d.prototype.EvaluateConstantNumberNode=function(j){var k=j.value.replace(/['"]/g,"");return +k};d.prototype.EvaluateLenNode=function(j){var k=j.args.parameters[0];return String(k.evaluate()).length};d.prototype.EvaluateFieldNameNode=function(y){var F=y.arguments;var n="";var m="";var x;for(var B=0;B<F.length;B++){n+=F[B].evaluate();m+=F[B].evaluate()+" "}var l=SiebelApp.QueryHelper.GetContext();var o;if(!c){o=l.GetWS()[l.GetActiveRow()]}else{o=c}var E="";var s="";var k="";try{E=l.GetFieldDefn(m.substring(0,m.length-1))}catch(p){return""}if(!E){var D=SiebelApp.OfflineUtils.RemoveNonAlphaChars(m);var w=l.GetDefn().Field;for(var j in w){if(SiebelApp.OfflineUtils.RemoveNonAlphaChars(j)===D){E=l.GetFieldDefn(j);break}}}if(E){k=E.CalExpr;if(!h.IsEmpty(k)){if(!E.PreQuery){var q=SiebelApp.Query.Parse(k);E.PreQuery=q}x=SiebelApp.Query.Evaluate(E.PreQuery,l,null,o);o[n]=x}x=o[n];if(E!==null||E!==""){switch(E.DataType){case"1":s=h.IsEmpty(x)?"":x;break;case"2":s=h.IsEmpty(x)?"":x;break;case"3":s=new SiebelApp.S_App.DatumPhoneObject();s.SetAsString(x);break;case"4":s=h.IsEmpty(x)?"":x;break;case"5":s=h.IsEmpty(x)?"":x;break;case"6":s=h.IsEmpty(x)?"":x;break;case"7":break;case"8":s=new SiebelApp.S_App.DatumBoolObject();s.SetValue(x);break;case"9":if(h.IsEmpty(x)){s="";break}s=+x;break;case"10":if(h.IsEmpty(x)){s="";break}var I=+x.substring(0,2);var H=+x.substring(3,5);var t=+x.substring(6,10);s=new SiebelApp.S_App.DatumDateObject();s.SetDate(t,I,H);break;case"11":s=new SiebelApp.S_App.DatumTimeObject();var C=+x.substring(0,2);var A=+x.substring(3,5);var u=+x.substring(6,8);var r=(60*A+60*60*C+u);s.SetValue(r);break;case"12":break;case"13":if(h.IsEmpty(x)){s="";break}var I=+x.substring(0,2);var H=+x.substring(3,5);var t=+x.substring(6,10);var J=+x.substring(11,13);var z=+x.substring(14,16);var G=+x.substring(17,19);var v=x.substring(20,22);if(v.toUpperCase()==="PM"){J=J+12}s=new SiebelApp.S_App.DatumUTCDateTimeObject();s.SetDateTime(t,I,H,J,z,G);break;case"14":break;case"15":break;default:break}}}return s};d.prototype.EvaluateUnaryNotNode=function(l){var k=l.evaluate();var j=k===true?false:true;return j};d.prototype.EvaluateUnaryIsNullNode=function(k){var j=k.evaluate();if(h.IsEmpty(j)){return true}return false};d.prototype.EvaluateIfNullNode=function(k){var m=k.args.parameters[0];var l=k.args.parameters[1];var j=m.evaluate();if(h.IsEmpty(j)){j=l.evaluate()}return j};d.prototype.EvaluateUnaryIsNotNullNode=function(k){var j=k.evaluate();if(h.IsEmpty(j)){return false}return true};d.prototype.EvaluateIIFNode=function(j){var m=j.args.parameters[0];var l=j.args.parameters[1];var k=j.args.parameters[2];if(m.evaluate()){return l.evaluate()}else{return k.evaluate()}};d.prototype.EvaluateRowIdToRowIdNumNode=function(k){var q=k.args.parameters[0].evaluate();if(typeof(q)=="object"){q=q.GetId()}var j=q.length;var p=0;var m=0;var o="";do{var n=q.charAt(m);var l=n.charCodeAt(0);if(!isNaN(parseInt(n))){if(n>=0&&n<=9){p=p*36+parseInt(n)}}else{if(l>="A".charCodeAt(0)&&l<"Z".charCodeAt(0)){p=p*36+parseInt((l-"A".charCodeAt(0)+10))}else{o+=p.toString();p=0;if(n){o+=n}}}m++}while(m<=j);return o};d.prototype.EvaluateFieldValueNode=function(j,k){return false};d.prototype.EvaluateLookupValueNode=function(j){var n=j.args.parameters[0].param;var m=j.args.parameters[1].param;var l=n.evaluate();var k=m.evaluate();return SiebelApp.S_App.Model.GetLovNameVal(k,l)};d.prototype.EvaluateLookupNameNode=function(j){var n=j.args.parameters[0].param;var m=j.args.parameters[1].param;var l=n.evaluate();var k=m.evaluate();return SiebelApp.S_App.Model.GetLovValName(k,l)};d.prototype.EvaluateIsNullNode=function(j){var m=j.args[0];var l=j.args[1];var k=m.evaluate();if(!h.IsEmpty(k)){return k}else{return l.evaluate()}};d.prototype.EvaluateLeftNode=function(j){var n=j.args[0];var m=j.args[1];var k=n.evaluate();var l=m.evaluate();return k.substring(0,l)};d.prototype.EvaluateRightNode=function(k){var n=k.args[0];var m=k.args[1];var l=n.evaluate();var j=m.evaluate();return l.substring(l.length-j)};d.prototype.EvaluateMidNode=function(j){var o=j.args[0];var n=j.args[1];var m=j.args[2];var l=o.evaluate();var p=n.evaluate();var k=m.evaluate();return l.substring(p,k)};d.prototype.EvaluateBinaryOpNode=function(k){var n=(k.left==="NULL")?SiebelApp.QueryHelper.GetValue().body.evaluate():k.left.evaluate();var m=(k.right==="NULL")?SiebelApp.QueryHelper.GetValue().body.evaluate():k.right.evaluate();var l=k.type;var j;switch(l){case"BINOPNODE_APLUS":if(typeof n.add==="function"&&typeof m.add==="function"){j=n.add(m)}else{if(typeof n.add==="function"&&(typeof m.add!=="function")){j=n.add(m)}else{if((typeof n.add!=="function")&&typeof m.add==="function"){j=m.add(n)}else{j=n+m}}}break;case"BINOPNODE_AMINUS":if(typeof n.subtract==="function"&&typeof m.subtract==="function"){j=n.subtract(m)}else{if(typeof n.subtract==="function"&&(typeof m.subtract!=="function")){j=n.subtract(m)}else{if((typeof n.subtract!=="function")&&typeof m.subtract==="function"){j=m.subtract(n)}else{j=n-m}}}break;case"BINOPNODE_AMULTIPLY":j=n*m;break;case"BINOPNODE_ADIVIDE":if(typeof n.divide==="function"&&typeof m.divide==="function"){j=n.divide(m)}else{j=n/m}break;case"BINOPNODE_APOWER":j=Math.pow(n,m);break;case"EQUAL":j=(n===m)?true:false;break;case"BINOPNODE_OR":if(n||m){j=true}else{j=false}break;case"BINOPNODE_AND":if(n&&m){j=true}else{j=false}break;case"BINOPNODE_CEQ":if(n===m){j=true}else{j=false}break;case"BINOPNODE_CNE":case"NOT_EQUAL":j=(n!==m)?true:false;break;case"BINOPNODE_CLE":if(n<=m){j=true}else{j=false}break;case"BINOPNODE_CGE":if(n>=m){j=true}else{j=false}break;case"BINOPNODE_CLT":if(typeof n.less==="function"&&typeof m.less==="function"){j=n.less(m)
}else{if(n<m){j=true}else{j=false}}break;case"BINOPNODE_CGT":if(typeof n.greater==="function"&&typeof m.greater==="function"){j=n.greater(m)}else{if(n>m){j=true}else{j=false}}break}return j};d.prototype.EvaluateEscapeCharaterNode=function(j){return j.value.value+" ESCAPE "+j.escapeChar};d.prototype.EvaluateParentFieldValueNode=function(j){var m=j.args.parameters[0].evaluate();var l=SiebelApp.QueryHelper.GetContext();var k="";if(l.GetParentBusComp()){k=(l.GetParentBusComp().GetWS()[l.GetParentBusComp().GetActiveRow()])[SiebelApp.OfflineUtils.RemoveNonAlphaChars(m)];k=k?k:""}return k};function i(j,k){if(!k){return j}return j.replace(/{{([\s\S]+?)}}/g,function(n,m){var o=k[m],l=$.type(o);return l!=="undefined"&&l!=="null"?o:m})}function f(q,y,A){var s,r,l,j="";s=new Date(A.m_nYear,A.m_nMonth-1,A.m_nDay);l=s.getTimezoneOffset();s.setMinutes(s.getMinutes()+l);r=new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),0,0);r.setHours(r.getHours()+23);r.setMinutes(r.getMinutes()+59);var u=s.getDate()<10?"0"+s.getDate():""+s.getDate();var m=s.getHours()<10?"0"+s.getHours():""+s.getHours();var w=s.getMinutes()<10?"0"+s.getMinutes():""+s.getMinutes();var p=s.getMonth()+1;var z=p<10?("0"+p).slice(-2):""+p;var t=r.getDate()<10?"0"+r.getDate():""+r.getDate();var k=r.getHours()<10?"0"+r.getHours():""+r.getHours();var v=r.getMinutes()<10?"0"+r.getMinutes():""+r.getMinutes();var o=r.getMonth()+1;var x=o<10?("0"+o).slice(-2):""+o;var n=s.getFullYear()+""+z+""+u+""+m+""+w;var C=r.getFullYear()+""+x+""+t+""+k+""+v;var B={"=":'{{value}} > "{{LR}}" AND {{value}} < "{{HR}}"',"<=":'{{value}} <= "{{HR}}"',">=":'{{value}} >= "{{LR}}"',"<":'{{value}} < "{{LR}}"',">":'{{value}} > "{{HR}}"'};B["<>"]=B.LIKE=B["="];j=i(B[q],{value:y,LR:n,HR:C});return"("+j+")"}d.prototype.BinaryOpNodeBoldQuery=function(j){var q=j.left;var n=j.right;var l=j.type;var p=" ";var m;var o;var k;if(l!=="BINOPNODE_OR"&&l!=="BINOPNODE_AND"){switch(l){case"BINOPNODE_CEQ":k="=";break;case"BINOPNODE_CNE":k="<>";break;case"BINOPNODE_CLT":k="<";break;case"BINOPNODE_CGT":k=">";break;case"BINOPNODE_CLE":k="<=";break;case"BINOPNODE_CGE":k=">=";break;case"BINOPNODE_CLIKE":k="LIKE";break}o=n.evaluate();m=q.BoldQuery();if(o&&typeof o.GetAsFormattedString==="function"){return f(k,m,o)}if(n.type!=="ESCAPECHAR_NODE"){o='"'+o+'"'}p+="("+m+" "+k+" "+o+")";return p}if(l==="BINOPNODE_OR"||l==="BINOPNODE_AND"){m=q.BoldQuery();o=n.BoldQuery();k=(l==="BINOPNODE_OR")?"OR":"AND";p="("+m+" "+k+" "+o+")";return p}};d.prototype.BoldQueryFieldNameNode=function(l){var s=l.arguments;var k="";var r="";var o="";var q=SiebelApp.QueryHelper.GetContext();var m=false;var w=SiebelApp.OfflineUtils.RemoveNonAlphaChars(q.GetName());var v=q.GetParentBusComp();var p=null;if(v){p=q.GetLinkDef();if(p.interTableName){m=true}}for(var n=0;n<s.length;n++){k+=s[n].evaluate()}r=SiebelApp.OfflineUtils.RemoveNonAlphaChars(k);if(!(SiebelApp.BrowserCacheMgr.DoesFieldExist(w,r))){SiebelJS.Log("Field"+r+"from the BC "+w+" not found")}var o=a.call(this,r,q);if(m){if(q.GetDefn().InterFieldInfo.InterFieldArr.indexOf(o)!==-1){var u=q.GetDefn().Fields[o].ColName;if(p&&SiebelApp.BrowserCacheMgr.DoesFieldExist(p.interTableName,u)){r=SiebelApp.OfflineUtils.RemoveNonAlphaChars(p.interTableName)+"."+u}else{SiebelJS.Log("Column"+u+"from the intertable "+p.interTableName+" not found")}}else{r=w+'."'+r+'"'}}else{r='"'+r+'"'}var j=null;if(o){j=q.GetDefn().Fields[o]}if(j&&(j.DataType==="10"||j.DataType==="12"||j.DataType==="13")){var t;t=q.DateFormatConverter(t,k);return t}return r};function a(j,l){var m=l.GetDefn().Fields;for(var k in m){if(m[k]){if(SiebelApp.OfflineUtils.RemoveNonAlphaChars(k)===j){return k}}}return null}d.prototype.BoldQueryUnaryIsNullNode=function(k){var j=k.BoldQuery();var l="";l+=j+' = ""';return l};d.prototype.BoldQueryUnaryIsNotNullNode=function(k){var j=k.BoldQuery();var l="";l+=j+' <> ""';return l};d.prototype.BoldQueryBracesNode=function(j){var k="";k=" ("+j.body.BoldQuery()+") ";return k};d.prototype.BoldQueryFunctionNode=function(j){var k="";switch(j.name){case"EXISTS":k="1=1"}return k};d.prototype.BoldQueryParameterListNode=function(k){var l="";for(var j=0;j<k.parameters.length;j++){l=l+k.parameters[j].BoldQuery()}return l};d.prototype.BoldQueryParameterNode=function(j){var k="";k=j.param.BoldQuery();return k};return e}())};