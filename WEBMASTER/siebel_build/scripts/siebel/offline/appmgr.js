/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2014
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 8.1.1.14SIA[23044]PATCHSET13 */
if(typeof(SiebelApp.OfflineAppMgr)==="undefined"){SiebelJS.Namespace("SiebelApp.OfflineAppMgr");SiebelApp.OfflineAppMgr=(function(){var a;var w=SiebelApp.Offlineconstants;var m=SiebelApp.OfflineAppSettings;var u=SiebelJS.Dependency("SiebelApp.Constants");var B=SiebelJS.Dependency("SiebelApp.Utils");var z=w.get("IS_DYNAMIC");var C=w.get("SHOW_POPUP");var y=w.get("SWEMETHOD");var h=w.get("BUILDSCREEN_BS_DRILLDOWN");var n=w.get("BUILDSCREEN_BS_DRILLDOWNBYFIELD");var d=w.get("BUILDSCREEN_BS_ALTERNATE");var g=w.get("BUILDSCREEN_BS_NORMAL");var s=w.get("BUILDSCREEN_BS_DRILLDOWNCUSTOM");var i=w.get("LOG_EVT_CLIENT_SYS");var k={Method:null,Action:null,Type:null};var q={context:"",type:"",objname:""};var f={};var G=[];var D="";var l="";var b=[];var p;var t=window.location.origin;t=t.concat(window.location.pathname);var o=SiebelApp.OfflineUtils;var c=function(){var K;var J=[];var L={BC:[],prevBC:[],RowId:""};var I=window.localStorage;var N={};var M=false;var H=false;if(!(JSON.parse(I.getItem("CacheType")))){I.setItem("CacheType",JSON.stringify("Reactive"))}this.SetCacheType=function(O){I.setItem("CacheType",JSON.stringify(O))};this.GetCacheType=function(){return(JSON.parse(I.getItem("CacheType")))};this.CallPendingOp=function(){N.asyncFn.apply(N.scope,N.args)};this.HasPendingOp=function(){return M};this.SetPendingOp=function(R,P,O,Q){if(R){N.asyncFn=P;N.args=O;N.scope=Q}else{N={}}M=R};this.SetStatus=function(O){l=O};this.GetStatus=function(){return l};this.GetIsCreatingPopup=function(){return H};this.SetIsCreatingPopup=function(O){H=O};this.GetControlRegExpMap=function(){if(!p){p={}}return p};this.SetControlRegExpMap=function(O){p=O};c=function(){return K};this.SetCmdMap=function(){J.push({cmd:"GotoBookmarkView",cmdTag:"oinf"});J.push({cmd:"GotoView",cmdTag:"oinf"});J.push({cmd:"GotoViewCold",cmdTag:"oinf"});J.push({cmd:"GetViewLayout",cmdTag:"gvl"});J.push({cmd:"GetAppletLayout",cmdTag:"nl"});J.push({cmd:"NewRecord",cmdTag:"nr"});J.push({cmd:"EditRecord",cmdTag:"er"});J.push({cmd:"WriteRecord",cmdTag:"wr"});J.push({cmd:"DeleteRecord",cmdTag:"dl"});J.push({cmd:"AddRecord",cmdTag:"ar"});J.push({cmd:"GetCachedFrame",cmdTag:"gcf"});J.push({cmd:"GotoPostedAction",cmdTag:"gpa"});J.push({cmd:"EditField",cmdTag:"ef"});J.push({cmd:"NewLayout",cmdTag:"nl"});J.push({cmd:"CreateRecord",cmdTag:"cr"});J.push({cmd:"ShowPopup",cmdTag:"puoinf"});I.setItem("cmdMap",JSON.stringify(J))};this.GetCmdMap=function(){if(I.getItem("cmdMap")){return(JSON.parse(I.getItem("cmdMap")))}else{this.SetCmdMap();return(JSON.parse(I.getItem("cmdMap")))}};this.GetOfflineAppContext=function(){return L};$.extend({callback:function(P,O){var Q=SiebelApp.OfflineAppMgr;var R;if(O){if(!Q.CheckResolvedState()){$.when.apply($,G).done(function(){if(!(Q.CheckResolvedState())){$.callback(P,O)}else{R=D;D={err:false};O.call(P,R)}})}else{R=D;D={err:false};O.call(P,R)}}else{$.setReturnValue({err:true})}},setReturnValue:function(O){D=O},eachAsyncOp:function(R,Q){if(!(Q instanceof Array)){if(!Q){return}Q=[Q]}else{if(!Q.length){return}}var P=0;var O=Q.length;var S=SiebelApp.OfflineAppMgr;var T=function(U){$.setReturnValue(U);if(P<O-1){P++;S.HandleSingleObj(R,Q[P]);$.callback(S,T)}};S.HandleSingleObj(R,Q[P]);$.callback(S,T)}});c.prototype=this;K=new c();K.constructor=c;return K};a=new c();c.prototype.ClearDeferredArray=function(){G=[];D={err:false}};c.prototype.GetCurrentRetVal=function(){return D};c.prototype.PostAppLoad=function(){if(m.GetUpSyncPostRefresh()){m.SetUpSyncPostRefresh(false);SiebelApp.SyncThreadHandler.SyncInUISession()}};c.prototype.PopulateDeferredArray=function(H){G.push(H)};c.prototype.RemoveObj=function(H){for(var I=0;I<G.length;I++){if(G[I]===H){break}}G.splice(I,1)};c.prototype.CheckResolvedState=function(){var H=G.length;for(var I=H-1;I>-1;I--){if((G[I].state()!=="resolved")){return false}}return true};c.prototype.HandleSingleObj=function(S,I){var L=S;var N=I.preExecute;var O=I.postExecute;var K=I.execute;var H=I.executeScope;var Q=I.iterations;var R;if(!Q){Q=1}var M=0;var P=this;if(N){R=N.call(L,M)}else{R=[]}var J=function(T){if(O){O.call(L,T)}if(M<Q-1){M++;if(N){R=N.call(L,M)}else{R=[]}K.apply(H,R);$.callback(P,J)}else{J=null}};K.apply(H,R);$.callback(P,J)};c.prototype.HandleNullResponse=function(L){var J=0;var H=B.DecodeFromQueryString(L);var I=H.GetProperty(w.get("SWECMD"));if(I==="GetLastTxn"){J="IDS_DOUI_ERR_SYNC";var K=SiebelApp.S_App.OfflineLocaleObject.GetLocalString(J);SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_ALL"),27,5,90,K]);alert(K)}else{return SiebelApp.OfflineAppMgr.HandleValidation(H)}};c.prototype.OfflineRequestHandler=function(I,J,H){this.ClearDeferredArray();if(SiebelApp.RequestProcessor.IsSupported(I,false,J)){SiebelApp.RequestProcessor.ProcessReq(I,J,H)}else{o.CcfLogEvent([i,68,5,61,I])}};c.prototype.HandleCallback=function(J,H,I){this.AddDefHandlers(J,H,I)};c.prototype.HandleValidation=function(){SiebelApp.S_App.uiStatus.Free()};c.prototype.IsCachableRequest=function(N){var M=[".js",".htm"];if(N!=="undefined"&&N!==""){var H=M.length;for(var K=0;K<H;K++){var I=M[K];if(N.indexOf(I)!==-1){var L=B.DecodeFromQueryString(N);var J=L.GetProperty("SWECmd");if(J){return true}else{return false}}}return true}else{return false}};c.prototype.CacheResponse=function(K,I){if(!SiebelApp.OfflineAppSettings.GetMode()&&!SiebelApp.S_App.GetActiveView()&&SiebelApp.OfflineAppMgr.IsCachableRequest(K)&&I[0]&&I[0]!=="undefined"&&I[0]!==""&&(SiebelApp.RequestProcessor.IsSupported(K))){if(I[0].indexOf("SBL-UIF-00335")!==-1){var H=window.location.pathname;H=H.concat("?SWENeedContext=false&SWECmd=Logoff&SWEBID=-1&SRN=&SWETS=");Top().location.replace(H);return false}if(r.call(this)){var L={};if((K.search("scriptfiles.txt")!==-1)){L.SweCmd=w.get("TEXT");L.ObjName="scriptfiles";L.Response=I[0];L.Type=w.get("DEFAULT_VIEW_INFO")}else{var J=B.DecodeFromQueryString(K);L.SweCmd=SiebelApp.RequestProcessor.GetCmdTag(J.GetPropertyAsStr("SWECmd"));L.ObjName=J.GetPropertyAsStr("SWEFrame");L.Response=I[0];L.Type=w.get("DEFAULT_VIEW_INFO")}if(L.ObjName){SiebelApp.BrowserCacheMgr.CacheOnlineOp(L)}return true}}};function r(){if(SiebelApp.OfflineAppSettings.GetPkgStatus()){if(SiebelApp.S_App.GetUserName){if(SiebelApp.S_App.GetUserName()!==SiebelApp.S_App.Model.GetLoginName()){return false}}var I=window.localStorage.getItem("appURL");if(I){I=JSON.parse(I)}var H=window.location;var J=H.origin.concat(H.pathname);if(I!==J){return false}}return true}c.prototype.SetContext=function(H,I,J){q={};q.context=H;q.type=I;q.objname=J};c.prototype.GetContext=function(){return q};c.prototype.ClearContext=function(){q={}};c.prototype.SetPickAppletContext=function(H){f=H};c.prototype.GetPickAppletContext=function(){return f};c.prototype.ClearPickAppletContext=function(){f={}};c.prototype.InvokeMethod=function(H,I,L,J){var K="OfflineAppMgr.InvokeMethod."+I;o.StartTime(K);o.CcfLogEvent([i,44,5,11,"methodName",I]);if(H.GetProperty(u.get("SWE_APPLET_STR"))){this.InvokeAppletMethod(H,I,L,J);$.callback(this,function(M){o.EndTime(K);if(M.err){$.setReturnValue({err:true})
}else{$.setReturnValue(M)}})}else{if(H.GetProperty(u.get("SWE_SERVICE"))&&H.GetProperty(u.get("SWE_SERVICE"))!==""){this.InvokeServiceMethod(H,I,L,J);$.callback(this,function(M){o.EndTime(K);$.setReturnValue(M)})}else{L.apply(this,[w.get("CUD_RESPONSE")])}}};c.prototype.CanInvokeMethod=function(K,O,Q,L){var I="OfflineAppMgr.CanInvokeMethod."+O,R=false;o.StartTime(I);if(K.GetProperty(u.get("SWE_SERVICE"))&&K.GetProperty(u.get("SWE_SERVICE"))!==""){var M=K.GetProperty("SWEService");if(M){SiebelApp.S_App.Model.SetIsInterFace(1);var N=SiebelApp.S_App.GetService(M);if(!B.IsEmpty(N)){N.CanInvokeMethod(O);$.callback(this,function(S){SiebelApp.S_App.Model.SetIsInterFace(-1);R=S.retVal})}else{SiebelApp.S_App.Model.SetIsInterFace(-1)}}}else{if(K.GetProperty(u.get("SWE_APPLET_STR"))){var H=unescape(K.GetPropertyAsStr(u.get("SWE_APPLET_STR"))),P,J=SiebelApp.S_App.GetActiveView().GetActiveApplet();if(J&&(J.GetParentApplet()!==null)&&(J.GetName()===H)){P=J}else{P=SiebelApp.S_App.GetActiveView().GetApplet(H)}P.CanInvokeMethodX(O);$.callback(this,function(S){R=S.retVal})}}$.callback(this,function(){var T=CCFMiscUtil_CreatePropSet(),W=u.get("SWE_PROP_SESSION_RANDOM_NUMBER");T.SetPropertyStr("Status",w.get("ACTION_RPC_OK"));T.SetPropertyStr("Result",R);var U=window.localStorage.getItem(W);if(U){T.SetPropertyStr(W,U);T.SetPropertyStr("UC","1")}var V=T.EncodeAsString(),S=[];S[0]=V;Q.apply(SiebelApp.S_App,S);o.EndTime(I)})};c.prototype.ClearPostedActions=function(){k={}};c.prototype.GetPostedAction=function(){return k};c.prototype.PostActions=function(J,H,I){k={};k.Method=H;k.Action=J;k.Type=I};c.prototype.BuildViewAsync=function(H,J,K,I){k={};k.Method=w.get("GOTOVIEW");k.Action=w.get("ACTION_RPC_BUILD_VIEW_ASYNC");k.Type=w.get("VIEW_INFO");k.ViewName=H;if(I&&I instanceof SiebelApp.S_App.OfflineBOInterface){I=I.GetOfflineBO()}k.BusObj=I;k.DrilldownDef=K;k.BuildScreenType=J};c.prototype.ClearQueueMethod=function(){b=[]};c.prototype.QueueMethod=function(K,H,L,I){var J={};J.objName=K;J.methodName=H;J.psInputArgs=L;if(I){J.methodType=I}else{J.methodType=w.get("TYPE_FRAME")}b.push(J)};function j(N){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("OfflineAppMgr.prototype.DoPostedActions")}var H=false;var L=CCFMiscUtil_CreatePropSet();switch(k.Action){case w.get("ACTION_RPC_REFRESH_VIEW"):var M=SiebelApp.S_App.GetActiveView().GetName();var I=SiebelApp.S_App.GetActiveView().GetActiveApplet();var K=SiebelApp.AjaxRequestMgr.GetActiveRequest();var O=B.DecodeFromQueryString(K.data);var J=O.GetProperty(y).toString();if(J==="UndoRecord"||J==="WriteRecord"){I.SetActiveControl(null)}if((k.Method!==w.get("GOTOVIEW"))&&(k.Method!==w.get("GOTOVIEWCOLD"))){M=M.concat("/",I.GetName())}SiebelApp.OfflineAppMgr.ShowView(N.request,k.Method,N.callback,M,k.Type,w.get("REFRESHLAYOUT"));H=true;break;case w.get("ACTION_RPC_COMPLETED"):SiebelApp.OfflineAppMgr.GetReturnPropSet(u.get("SWE_RPC_PROP_STATUS_COMPLETED"),L,N.request,N.callback);H=true;break;case w.get("ACTION_RPC_CONTINUE"):SiebelApp.OfflineAppMgr.GetReturnPropSet(u.get("SWE_RPC_PROP_STATUS_CONTINUE"),L,N.request,N.callback);H=true;break;case w.get("ACTION_RPC_CLOSE_POPUP"):SiebelApp.OfflineAppMgr.GetReturnPropSet(u.get("SWE_RPC_PROP_CLOSE_POPUP"),L,N.request,N.callback);H=true;break;case w.get("ACTION_RPC_BUILD_VIEW_ASYNC"):M=k.ViewName;SiebelApp.OfflineAppMgr.ShowView(N.request,k.Method,N.callback,M,k.Type,"",k.BuildScreenType,k.DrilldownDef,k.BusObj);H=true;break}$.callback(this,function(P){$.setReturnValue(P);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("OfflineAppMgr.prototype.DoPostedActions")}});return H}c.prototype.ShowViewOrApplet=function(J,M){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("OfflineAppMgr.prototype.ShowViewOrApplet")}var I=this.GetContext();var L=I.objname;if(!L){var H=SiebelApp.S_App.GetActiveView().GetName();var K=SiebelApp.S_App.GetActiveView().GetActiveApplet().GetName();L=H.concat("/",K)}if(I.context===u.get("SWE_RPC_PROP_APPLET")){SiebelApp.OfflineAppMgr.ShowView(M.request,J,M.callback,L,I.type,w.get("NEWPOPUP"))}else{if(I.context===u.get("SWE_RPC_PROP_VIEW")){SiebelApp.OfflineAppMgr.ShowView(M.request,J,M.callback,L,I.type)}}SiebelApp.OfflineAppMgr.ClearContext();$.callback(this,function(N){$.setReturnValue(N);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("OfflineAppMgr.prototype.ShowViewOrApplet")}})};c.prototype.ShowView=function(I,H,U,O,R,M,V,P,L){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("OfflineAppMgr.prototype.ShowView")}var Q=SiebelApp.AjaxRequestMgr.GetActiveRequest();if(Q&&Q.data){var T;T=B.DecodeFromQueryString(Q.data);var K=(T.propArray.hasOwnProperty("SWEBMC")||unescape(T.GetPropertyAsStr(w.get("SWECMD")))===w.get("GOTOVIEW"))?true:false;if(K){var N=[];N=JSON.parse(window.localStorage.getItem(w.get("VIEW_LIST")));if(N.indexOf(O)===-1){o.CcfLogEvent([i,97,5,100,O]);SiebelApp.OfflineAppMgr.ShowRPCError("",U,I);return}}}o.StartTime("OfflineAppMgr.ShowView");if(!M){var J=SiebelApp.S_App.GetActiveView();if(J){var S=B.DecodeFromQueryString(I).GetPropertyAsStr("SWESP");if(B.IsTrue(S)){M=w.get("NEWPOPUP")}else{M=w.get("NEWLAYOUT")}}else{M=w.get("NEWLAYOUT")}}SiebelApp.S_App.BuildView(I,H,U,O,R);$.callback(this,function(X){var W=CCFMiscUtil_CreatePropSet();W.DecodeFromString(X.retVal);SiebelApp.OfflineAppMgr.GetReturnPropSet(M,W,I,U,V,P,L);$.callback(this,function(Y){$.setReturnValue(Y);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("OfflineAppMgr.prototype.ShowView")}o.EndTime("OfflineAppMgr.ShowView")})})};c.prototype.GetReturnPropSet=function(ad,I,ab,Q,ag,X,L){if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("OfflineAppMgr.prototype.GetReturnPropSet")}var P=SiebelApp.S_App;var R=null;var N=[];var V="";this.SetStatus(ad);var af=u.get("SWE_HIST_OUI_UPDATE_INFO");I.SetPropertyStr(w.get("STATUS"),ad);var ah=u.get("SWE_PROP_SESSION_RANDOM_NUMBER");var S=window.localStorage.getItem(ah);if(S){I.SetPropertyStr(ah,S)}o.CcfLogEvent([i,73,5,62,ad]);if(ad!==w.get("REFRESHLAYOUT")&&ad!==w.get("NEWLAYOUT")&&ad!==w.get("NEWPOPUP")){this.ClearPostedActions();var J=P.GetActiveView();if(J){J.GetNotifyPropSet(I,ab);var O=CCFMiscUtil_CreatePropSet();O.SetType(af);O.SetProperty(u.get("SWE_HIST_NAV_URL"),HtmlEncode(t));O.SetProperty(z,true);I.AddChild(O)}$.callback(this,function(aj){if(!aj.err){V=I.EncodeAsString();N[0]=V;var ai=Q.apply(P,N);if(ai&&ai.done){ai.done(function(){$.callback(this,function(ak){$.setReturnValue(ak);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("OfflineAppMgr.prototype.GetReturnPropSet")}I=null;ab=null;V=null;N=null;J=null})})}else{$.callback(this,function(ak){$.setReturnValue(ak);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("OfflineAppMgr.prototype.GetReturnPropSet")}I=null;ab=null;V=null;N=null;J=null})}}else{$.setReturnValue(aj)}})}else{var K=u.get("SWE_RPC_PROP_NEW_POPUP");var U="";var T;var aa;if(typeof ab==="string"){U=B.DecodeFromQueryString(ab)
}T=B.IsEmpty(X)?"":X.viewname;var W=P.GetActiveView();var ac=B.IsEmpty(W)?"":W.GetName();var H;var Z=false;var ae=U.GetPropertyAsStr(u.get("SWE_ARG_KEEP_CONTEXT"));if(!ae){ae=0}if(ag===h||ag===n){if(!X){$.setReturnValue({err:true});return}if(T==="Drill Down To Same View"){T=ac}if(B.IsEmpty(T)){$.setReturnValue({err:true});return}}if(!ag){if(ae){H=d;Z=true}else{H=g}}else{H=ag;Z=true}var Y=null;if(W){Y=W.GetActiveApplet()}var M;if(Y){if(H===h||H===n){M=Y.GetBusComp();if(M.IsCommitPending()){M.WriteRecord()}}}$.callback(this,function(){var av=u.get("SWE_PST_APP_INFO");var az=u.get("SWE_PST_BUSOBJ_INFO");var aC=u.get("SWE_PST_NEW_BUSOBJ");var aD=u.get("SWE_PST_VIEW_INFO");var ax=u.get("SWE_PROP_NAME");var aB;if(Y&&(H===h||H===n)){var aE=Y.GetName();if(B.IsEmpty(aE)){return}}var ap=CCFMiscUtil_CreatePropSet();if(ad!==K){var am=I.EnumProperties(true);do{ap.SetProperty(am,I.GetProperty(am))}while((am=I.EnumProperties(false)))}if(ad===K){if(U&&U.PropertyExists(y)){var an=U.GetProperty(y).toString();if(an===C){I.SetProperty("URL",I.GetProperty("URL").toString()+"&ObjName="+U.GetProperty("SWETA").toString()+"&Type="+w.get("POPUP_INFO"))}}this.SetIsCreatingPopup(true);R=P.ProcessNewPopup(I)}I.propArray=[];I.propArrayLen=0;if(I.propEnumArray){I.propEnumArray=[];I.propEnum=0}ap.SetProperty(z,true);var aj=CCFMiscUtil_CreatePropSet();var ak=CCFMiscUtil_CreatePropSet();var au=CCFMiscUtil_CreatePropSet();aj.SetType(av);ak.SetType(aD);au.SetType(az);aj.SetProperty(z,true);ak.SetProperty(z,true);au.SetProperty(z,true);var ao=u.get("SWE_RPC_PROP_NOTIFICATION");var aA=P.GetActiveBusObj();var ai=null;var ar=null;var aq;if(Y&&(H===h||H===n)){if(!X.busCompName){ar=Y.GetName()}else{ar=X.busCompName}if(H===h&&W.GetBusObj().GetName()===ai&&ar===Y.GetBusComp().GetName()){H=d}}if(H===s){H=g}else{if(H===h||H===n){Z=true;if(ac===T){aB=true}if(!L&&Y!==null){if(H===n){aq=X.destFieldName;M.FieldValue(X.srcFieldName)}if(H===h){aq=u.get("SWE_ROW_ID_FIELD");M.FieldValue(u.get("SWE_ROW_ID_FIELD"));ar=Y.GetBusComp().GetName()}}}}var al;if(aA){var aw=I.GetChildByType(av);var at=aw.GetChildByType(aC);if(at){al=at.GetChildByType(az);var ay=aA.GetName();ai=at.GetChildByType(az).GetProperty(ax);if(ay!==ai||!Z){H=g}}else{al=aw.GetChildByType(az)}}else{H=g}if(L){al.SetPropertyStr("boexist",true)}$.callback(this,function(aM){if(aM){if(!aM.err){if(!B.IsEmpty(aM.retVal)){aa=aM.retVal}}else{return}}if(ad===K&&aA){al.SetProperty("isPopup",true);au.SetProperty("isPopup",true)}if(H===d||H===h||H===n){al.SetProperty("keepBO",true)}var aH=I.FindChildPosition(ao);if(aH>=0){I.RemoveChild(aH)}var aL=I.GetChildByType(af);var aJ;if(aL){aL.SetProperty(u.get("SWE_HIST_NAV_URL"),HtmlEncode(t));aJ=aL.Clone();aJ.SetProperty(z,true)}var aG=["dPS",av,aD,az];var aF=[ap,aj,ak,au];SiebelApp.S_App.Model.SetDyncPS(aG,aF,4);V=I.EncodeAsString();N.push(V);N.push("success");o.CcfLogEvent([i,74,5,62,"Static"]);var aK=P.ProcessResponse.apply(P,N);var aI=this;aK.done(function(){aI.ClearPostedActions();var aN=0;var aO=P.GetActiveView();aO.ActivateFields();$.callback(SiebelApp.OfflineAppMgr,function(){var aQ=X?X.visibilityType:null;var aP=P.GetActiveBusObj();SiebelApp.S_App.Model.EndSetupView(aP,T,ar,aq,aa,aQ);$.callback(this,function(aW){if(!aW.err){var aV=false;var aS;if(window.localStorage.getItem("reload")&&JSON.parse(window.localStorage.getItem("reload"))&&window.localStorage.getItem("contextArray")){aV=true;aS=JSON.parse(window.localStorage.getItem("contextArray"));aN=aS.length}if(aV){var aR=false;for(var aT=0;aT<aN;aT++){var aU=aP.GetBusCompX(aS[aT].bc,true);if(aU){if(!B.IsEmpty(aS[aT].ss)){aU.SetSearchSpec(aS[aT].ss)}if(aS[aT].cursor&&aS[aT].cursor>0){var aX=aU.GetCursor();aX[0]=aS[aT].cursor;aU.SetCursor(aX)}aR=true}}if(!aR){window.localStorage.setItem("reload",false)}}aO.Populate();$.callback(this,function(){$.callback(this,function(a7){if(!a7.err){var aY,a9,aZ;a9=aO.GetAppletMap();var a8=null;var a3=SiebelApp.AjaxRequestMgr.GetActiveRequest();if(a3&&a3.data){var a6;a6=B.DecodeFromQueryString(a3.data);var a5=a6.propArray.hasOwnProperty("SWEBMC");if(a5){o.CcfLogEvent([i,98,5,100,aO.GetName()]);var a4=a6.GetProperty("SWEApplet0");a4=a4?unescape(a4):a4;var a1=a6.GetProperty("SWERowId0");if(!a4){var a0=B.DecodeFromQueryString(window.location.href);a4=a0.GetProperty("SWEApplet0");a4=a4?unescape(a4):a4;a1=a0.GetProperty("SWERowId0")}if(a4&&a1){var a2=a9[a4]?a9[a4].GetBusComp():undefined;if(a2){o.CcfLogEvent([i,99,5,100,(" Applet: "+a4+" ,RowId: "+a1)]);a2.PositionById(a1)}}}}while(b.length>0){aY=b.shift();if(aY.methodType===w.get("TYPE_BUSCOMP")){for(a8 in a9){if(a9[a8].GetBusComp().GetName()===aY.objName){aZ=a9[a8];break}}}else{if(aY.methodType===w.get("TYPE_FRAME")){for(a8 in a9){if(a9[a8].GetName()===aY.objName){aZ=a9[a8];break}}}}}if(aZ){if(aY.methodName){aZ.InvokeMethodX(aY.methodName,aY.psInputArgs)}}$.callback(this,function(bf){if(!bf.err){aP=P.GetActiveBusObj();if(!aL.GetProperty(u.get("SWE_HIST_REPLACE"))){window.localStorage.setItem("view",aO.GetName());var bj=[];var be="";for(var bb in a9){if(a9[bb]){var ba=a9[bb];var bh=ba.GetBusComp();if(!bh){continue}var bi=bh.GetName();if((be.indexOf(bi)===-1)&&!(bh.IsCommitPending())&&!((typeof(ba.GetAssocAppletName)!=="undefined")||(typeof(ba.GetPickAppletName)!=="undefined"))){var bg={};be=be.concat(bi);bg.bc=bi;bg.ss=bh.GetSearchSpec();bg.sc=bh.GetScrollCount();if(bh.CheckActiveRow()&&bh.GetWS()[bh.GetActiveRow()]){bg.Id=bh.GetWS()[bh.GetActiveRow()].Id}bj.push(bg)}}}var bd=[];bd=SiebelApp.OfflineAppMgr.SortBCOrder(bj,bd);window.localStorage.setItem("contextArray",JSON.stringify(bd))}aO.InterpolateDyncUIPS(ak);$.callback(this,function(){aP.InterpolateBCPS(au);$.callback(this,function(){aj.AddChild(au);aj.AddChild(ak);ap.AddChild(aj);ap.AddChild(aJ);aO.GetNotifyPropSet(ap,ab);$.callback(this,function(){aO.SetNotifyObjData(au);$.callback(this,function(bm){var bl=function(){SiebelApp.OfflineAppMgr.SetStatus("");bk=null;ap=null;a6=null;aj=null;ak=null;au=null;aL=null;I=null;aP=null;I=null;ab=null;V=null;N=null;W=null;aK=null};if(!bm.err){var bc=ap.EncodeAsString();o.CcfLogEvent([i,74,5,62,"Dynamic"]);var bk=Q.call(P,bc);bk.done(function(){SiebelApp.S_App.Model.ResetDyncPS();var bn=SiebelApp.OfflineAppMgr.HasPendingOp();SiebelApp.OfflineAppMgr.SetIsCreatingPopup(false);if(bn){SiebelApp.S_App.ProcessCallbacks(R,[]);SiebelApp.OfflineAppMgr.CallPendingOp();$.callback(this,function(){SiebelApp.S_App.ProcessCallbacks(R,[]);SiebelApp.OfflineAppMgr.SetPendingOp(false);$.setReturnValue(bm);bl.call(this);bl=null})}else{$.setReturnValue(bm);bl.call(this);bl=null;SiebelApp.OfflineAppMgr.PostAppLoad()}})}else{$.setReturnValue(bm);bl.call(this);bl=null}})})})})}})}})})}})})})})})}};c.prototype.SortBCOrder=function(H,M,K){var J=SiebelApp.S_App.GetActiveBusObj();if(H.length===1){M.push(H[0]);H.splice(0,1);return M}else{if(H.length===0){return M}}for(var I=0;I<H.length;I++){var L=J.GetBusCompX(H[I].bc,true);if(!L.GetParentBusComp()||(L.GetParentBusComp().GetName()===K)){M.push(H[I]);H.splice(I,1);this.SortBCOrder(H,M,L.GetName())
}}return M};c.prototype.InvokeAppletMethod=function(H,I,O,N){o.CcfLogEvent([i,44,5,21,"methodName",I]);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().StartTime("OfflineAppMgr.prototype.InvokeAppletMethod")}var M;var L;var K=unescape(H.GetProperty(u.get("SWE_APPLET_STR")).toString());L=SiebelApp.S_App.GetActiveView().GetActiveApplet();if(L&&(L.GetParentApplet()!==null)&&(L.GetName()===K)){M=L}else{M=SiebelApp.S_App.GetActiveView().GetApplet(K)}var J=H.GetProperty(w.get("SWE_FRAME_ID_STR"));M.PrepareToInvokeMethod(I,N);$.callback(this,function(){M.SetDefaultShowMode();var P={};P.callback=O;P.request=N;var Q=CCFMiscUtil_CreatePropSet();Q.SetProperty("Request",N);M.InvokeMethodX(I,Q);$.callback(this,function(R){if(!R.err){if(k.Action){j.call(this,P)}else{if(!J){SiebelApp.OfflineAppMgr.ShowViewOrApplet(I,P)}else{this.PostActions(w.get("ACTION_RPC_COMPLETED"),I);j.call(this,P)}}$.callback(this,function(S){if(!S.err){SiebelApp.OfflineAppMgr.ClearPostedActions();$.setReturnValue(S);if(SiebelApp.S_App.GetTimer()){SiebelApp.S_App.GetTimer().EndTime("OfflineAppMgr.prototype.InvokeAppletMethod")}}else{$.setReturnValue({err:true});return}})}else{if(R.err){SiebelApp.OfflineAppMgr.ClearPostedActions();$.setReturnValue({err:true});return}}})})};c.prototype.PrepareWriteRecordResponse=function(H){var K=CCFMiscUtil_CreatePropSet();K.DecodeFromString(H);var T=K.GetChildByType("api");var X;var N;var O=T.GetChildByType("nbo");O=O.GetChildByType("boi");var S=T.FindChildPosition("nbo");T.RemoveChild(S);T.AddChild(O);var J=null;var U=T.GetChildByType("nv");var M=U.GetChildByType("vi");var I=M.Clone("vi");var L=M.GetChildCount();for(var P=0;P<L;P++){I.RemoveChild(0)}for(P=0;P<L;P++){var Q=M.GetChild(P);var R=Q.GetChildCount();X=null;N=null;var W=Q.GetType();if(W==="na"){X=CCFMiscUtil_CreatePropSet();X.SetType("rctl")}else{if(W==="nla"){N=CCFMiscUtil_CreatePropSet();N.SetType("rcl");X=CCFMiscUtil_CreatePropSet();X.SetType("rctl")}}if(R>0){for(var V=0;V<R;V++){J=Q.GetChild(V);if(J.GetType()==="ai"){if(X){J.InsertChildAt(X,0)}if(N){J.InsertChildAt(N,0)}if(W==="na"){if(J.GetPropertyAsStr(u.get("SWE_PST_APPLET_MODE"))===u.get("SWE_PST_APPLET_MODE_BASE")){J.SetPropertyStr(u.get("SWE_PROP_IS_EDIT"),"0")}}}I.AddChild(J)}}else{I.AddChild(Q)}}S=T.FindChildPosition("nv");T.RemoveChild(S);T.AddChild(I);K.SetProperty("Status","RefreshLayout");var Y=K.EncodeAsString();return Y};c.prototype.ShowRPCError=function(K,O,M){var J=CCFMiscUtil_CreatePropSet();var I=CCFMiscUtil_CreatePropSet();var N=CCFMiscUtil_CreatePropSet();if(K&&K.HasErrorMsg()){var H=K.GetErrorCodeString();var L=K.GetErrorText();I.SetProperty("ErrMsg",L);I.SetProperty("ErrCode",H);N.SetType("Errors");N.AddChild(I);J.AddChild(N)}SiebelApp.OfflineAppMgr.GetReturnPropSet("Error",J,M,O)};c.prototype.CheckValidation=function(K){var I=K.GetType();var H=true;if(I==="Ack_ValidateRequest"){SiebelApp.OfflineAppSettings.SetMode(false);var J=K.GetPropertyAsStr("Status");alert(J);$(".progressbar").remove();SiebelApp.S_App.UpdateSyncStatus("DownLoadFailed");H=false}return H};c.prototype.CheckServerConnection=function(J,I,M){var K=false;SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_COMMON"),39,5,86,""]);if(M){if(!(J.indexOf("<!DOCTYPE")!==-1&&J.indexOf("scripts/login.js")!==-1)&&!(J.indexOf("SWECmd=Login")!==-1&&J.indexOf('alert("')!==-1)){K=true}}else{var H=J.length;if(H<=3&&J.indexOf("OK")!==-1){K=true}else{if(J.indexOf("loadedfromcache")!==-1){K=false}else{if(J.indexOf("<!DOCTYPE")===0&&J.indexOf("manifest")!==-1){K=true}else{if(!I&&SiebelApp.OfflineUtils.IsValidServerResponse(J)){K=true}else{if(J.indexOf('name="SWECmd"')!==-1&&J.indexOf('value="Ping"')!==-1){K=true}else{if(J.indexOf("SWECmd=Login")!==-1&&J.indexOf('alert("')!==-1){window.localStorage.setItem("SRN","");K=true}}}}}}}if(!K&&I){if(SiebelApp.OfflineAppSettings.GetPkgStatus()){if(SiebelApp.OfflineAppSettings.GetMode()){SiebelApp.OfflineAppSettings.SetUpSyncStatus(true);SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_COMMON"),21,5,86])}this.HandleNetworkError(J)}else{var L=SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_DOUI_ERR_OFFLINE_PKG");SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_COMMON"),27,5,86,L]);alert(L)}}SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_COMMON"),39,5,86,K?"Passed":"Failed"]);return K};c.prototype.HandleNetworkError=function(J){var K=J;var H=window.location;var I=H.origin.concat(H.pathname);var M=SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_CLIENT_CONTINUE_WORK_OFFLINE");var L='<link id="OfflineButton" type="text/css" rel="stylesheet" href="files/theme-aurora.css"/><script>function OnClick(){window.localStorage.setItem("UpSyncInProgress", JSON.stringify(false));window.localStorage.setItem("WorkOffline", JSON.stringify(true)); window.location.href = "'+I+'";}<\/script>';L=L+'<div id="returntoappcontainer" class="siebui-rta-c"><div class="siebui-rta-logo"></div><input id="continueofflinebutton" type="button" value="'+M+'" onclick="OnClick()" class="siebui-rta-btn"/></div>';document.open("text/html");document.write(K,L);document.close()};c.prototype.Ping=function(H){var J=SiebelApp.S_App.GetPageURL();var L=window.localStorage.getItem("SRN");J=J+"?SWECmd=Ping";if(L.length){J=J+"&SRN="+L;var I=Math.random();J=J+"&SWETS="+I}var K;SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_COMMON"),82,5,92,""]);$.ajax({type:"POST",async:false,url:J,success:function(M){if(SiebelApp.OfflineAppMgr.CheckServerConnection(M,true)){K=true;if(H&&!(M.length<=3&&M.indexOf(w.get("SRVR_RESPONSE_OK"))!==-1)){K=false}}SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_COMMON"),82,5,92,K?"Passed":"Failed"])},complete:function(M,N){if(N==="error"){SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_COMMON"),82,5,92,"Failed"]);K=e.call(this)}}});return K};function e(){var H;SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_COMMON"),83,5,93,""]);$.ajax({type:"POST",url:window.location.href,data:window.location.href,async:false,success:function(J){if(J){if(SiebelApp.OfflineAppSettings.GetMode()){SiebelApp.OfflineAppSettings.SetUpSyncStatus(true)}var I=window.location.origin.concat(window.location.pathname)+"?";I=I+"&SWETS="+Math.random();SiebelApp.S_App.uiStatus.Busy({mask:true,timeOut:false});var K=SiebelApp.Offlineconstants.get("DM_APP_REDIRECT_TIMEOUT");K=parseInt(K);setTimeout(function(){SiebelApp.S_App.uiStatus.Free();SiebelApp.OfflineAppSettings.ReloadApp()},K);H=false;SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_COMMON"),86,5,93])}},complete:function(I,K,J){if(K==="error"){SiebelApp.OfflineAppMgr.HandleServerUnavailabilty();H=false;SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_COMMON"),87,5,93])}}});return H}c.prototype.HandleServerUnavailabilty=function(){var H="";if(!SiebelApp.OfflineAppSettings.GetMode()){if(SiebelApp.OfflineAppSettings.GetPkgStatus()){SiebelApp.OfflineAppSettings.OnSuccessfulDataDownload();var I=window.location;I.replace(I.origin.concat(I.pathname))}else{H=SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_DOUI_ERR_OFFLINE_PKG");
SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_COMMON"),27,5,91,H]);alert(H)}}else{H=SiebelApp.S_App.OfflineLocaleObject.GetLocalString("IDS_DOUI_ERR_SYNC");SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_COMMON"),27,5,91,H]);alert(H)}};c.prototype.ModifyLayout=function(H){var J=this.GetControlRegExpMap();for(var I in J){if(J[I]){H=H.replace(J[I],I)}}J=null;SiebelApp.OfflineAppMgr.SetControlRegExpMap(null);return H};c.prototype.InvokeServiceMethod=function(I,Q,U,K){var T=CCFMiscUtil_CreatePropSet();var N=CCFMiscUtil_CreatePropSet();var M=I.GetProperty("SWEService");var P=false;SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_CLIENT_SYS"),50,5,94,M,Q]);if(M!==""){SiebelApp.S_App.Model.SetIsInterFace(1);var O=SiebelApp.S_App.GetService(M);if(!B.IsEmpty(O)){P=true;var S=I.GetPropertyAsStr(u.get("SWE_INPUT_PS"));S=unescape(S);var L=CCFMiscUtil_CreatePropSet();L.DecodeFromString(S);var H=L.GetType();var J=L.GetValue();var R;if(L.GetPropertyCount()>0||L.GetChildCount()>0||(!B.IsEmpty(J))||(!B.IsEmpty(H))){R=L}else{R=I}if(Q==="SetProperty"||Q==="PropertyExists"||Q==="RemoveProperty"||Q==="GetProperty"||Q==="GetFirstProperty"||Q==="GetNextProperty"){N=F.call(this,O,Q,R)}else{O.Invoke(Q,L)}$.callback(this,function(X){SiebelApp.S_App.Model.SetIsInterFace(-1);if(X.err){SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_CLIENT_SYS"),84,5,94,X.err]);$.setReturnValue(X);return}else{var W={};W.request=K;W.callback=U;var V=j.call(this,W);if(V){return}if(X.retVal){N=X.retVal}N.SetType("ResultSet");T.AddChild(N);SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_CLIENT_SYS"),85,5,94,JSON.stringify(N)]);this.GetReturnPropSet(u.get("SWE_RPC_PROP_STATUS_COMPLETED"),T,K,U)}})}else{SiebelApp.S_App.Model.SetIsInterFace(-1)}}if(P){return}if(Q==="PrepareAppletMenu"){P=true;E.call(this,I,Q,U,K)}else{if(Q==="BatchCanInvoke"){P=true;A.call(this,I,Q,U,K)}else{v.call(this,I,Q,U,K,true);return}}if(P){$.callback(this,function(V){if(V.err){SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_CLIENT_SYS"),84,5,94,V.err]);$.setReturnValue(V);return}else{N=V.retVal;T.AddChild(N);T.SetType("ResultSet");SiebelApp.OfflineUtils.CcfLogEvent([w.get("LOG_EVT_CLIENT_SYS"),85,5,94,JSON.stringify(N)]);SiebelApp.OfflineAppMgr.GetReturnPropSet("1",T,K,U)}})}};function F(M,P,K){var J=M.Invoke("GetPropertySet");var H;var O;var I;var N;var L=CCFMiscUtil_CreatePropSet();if(!J){return}if(P==="SetProperty"){H=K.GetProperty("Name");O=K.GetProperty("value");J.SetProperty(H,O)}else{if(P==="PropertyExists"){H=K.GetProperty("Name");I=J.PropertyExists(H);L.SetProperty("Value",I?1:0)}else{if(P==="RemoveProperty"){H=K.GetProperty("Name");J.RemoveProperty(H)}else{if(P==="GetProperty"){H=K.GetProperty("Name");O=J.GetProperty(H);L.SetProperty("Value",O)}else{if(P==="GetFirstProperty"){H=J.GetFirstProperty();O=J.GetProperty(H);L.SetProperty("Name",H);L.SetProperty("Value",O);L.SetProperty("Iterator","1")}else{if(P==="GetNextProperty"){N=K.GetProperty("Iterator");if(J.GetPropertyCount()>0){H=J.propEnumArray[N];O=J.GetProperty(H);L.SetProperty("Name",H);L.SetProperty("Value",O);L.SetProperty("Iterator",N)}}}}}}}return L}function A(H,O,P,K){var Q;var N=CCFMiscUtil_CreatePropSet();var J=CCFMiscUtil_CreatePropSet();var L;var M=unescape(H.GetProperty("SWEIPS"));J.DecodeFromString(M);Q=J.EnumProperties(true);var I=function(){v.call(this,H,Q,"","",false);$.callback(this,function(R){if(R.err){$.setReturnValue(R);return}L=R.retVal;if(L){N.SetProperty(Q,true)}else{N.SetProperty(Q,false)}});if(Q=J.EnumProperties(false)){I.call(this)}};I.call(this);$.callback(this,function(){$.setReturnValue({err:"",retVal:N})})}function E(I,P,Q,L){var K=CCFMiscUtil_CreatePropSet();var H;var N=w.get("MENU_INFO");var J=w.get("MENU_DATA_REQ");var M;M=I.GetProperty("SWEIPS").toString();M=unescape(M);if(!B.IsEmpty(M)){var O=CCFMiscUtil_CreatePropSet();O.DecodeFromString(M);M=O.GetProperty("Name");if(B.IsEmpty(M)){M=I.GetProperty("SWEActiveApplet").toString()}}else{M=I.GetProperty("SWEActiveApplet").toString()}SiebelApp.BrowserCacheMgr.DiscoverMetadata(L,Q,J,M,N);$.callback(this,function(R){if(R.err){$.setReturnValue(R);return}H=R.retVal;K.DecodeFromString(H);$.setReturnValue({err:"",retVal:K});return})}function v(I,L,U,M,R){var P="";var J=null;var S="";var H="";var O={};var Q=u.get("PROP_SERVICE");if(!L){$.setReturnValue({err:"",retVal:false});return}O=x.call(this,L);if(!O){$.setReturnValue({err:"",retVal:false});return}if(O[u.get("PROP_TARGET")]!=="Server"&&O[u.get("PROP_TARGET")]!=="SI Plus"){var K=SiebelApp.S_App.GetActiveView();if(O[u.get("PROP_APPLET")]){if(K===null){$.setReturnValue({err:"",retVal:false});return}}if(O[u.get("PROP_TARGET")]!=="Browser Applet"&&K&&K.GetName()==="Task Pane View"){if(O.method!=="Logoff"){$.setReturnValue({err:"",retVal:false});return}}}if(O[u.get("PROP_ARGUMENT")]){I.SetProperty("Method Argument",O[u.get("PROP_ARGUMENT")])}I.SetProperty("Command",L);if(O[Q]!==" "&&O[Q]){P=O[Q];S=O.method;J=SiebelApp.S_App.GetService(P);if(J){if(R){J.Invoke(S,I);$.callback(this,function(V){if(V.err){$.setReturnValue(V);return}})}else{J.DoCanInvokeMethod(S);$.callback(this,function(V){if(V.err){$.setReturnValue(V);return}else{var W=V.retVal;$.setReturnValue({err:"",retVal:W});return}})}}}else{if(O[u.get("PROP_APPLET")]){H=O[u.get("PROP_APPLET")];S=O.method;if(!R){var T;var N=SiebelApp.S_App.GetActiveView().GetActiveApplet();if(N&&(N.GetParentApplet()!==null)&&(N.GetName()===H)){T=N}else{T=SiebelApp.S_App.GetActiveView().GetApplet(H)}T.CanInvokeMethodX(S);$.callback(this,function(W){if(W.err){$.setReturnValue(W);return}else{var V=W.retVal;$.setReturnValue({err:"",retVal:V});return}})}}else{$.setReturnValue({err:"",retVal:false});return}}}function x(L){var H={};var J=[];var K=CCFMiscUtil_CreatePropSet();var I=0;if(!L){return}if(L.indexOf(u.get("CMDMGR_AT"))>=0){K.DecodeFromString(L);return(true)}if(L.indexOf(u.get("CMDMGR_STAR"))<0){return(false)}J=L.split(u.get("CMDMGR_STAR"));for(I=0;I<J.length;I++){if(I===0){continue}switch(I){case 1:H[u.get("PROP_TARGET")]=J[I];break;case 2:H[u.get("PROP_SERVICE")]=J[I];break;case 3:H[u.get("PROP_METHOD")]=J[I];break;case 4:H[u.get("PROP_APPLET")]=J[I];break;case 5:H[u.get("PROP_ARGUMENT")]=J[I];break;case 6:H[u.get("PROP_DX")]=J[I];break;case 7:H[u.get("PROP_DY")]=J[I];break;case 8:H.popup=J[I];break;default:break}}return(H)}return a}())}if(typeof(SiebelApp.S_App.HistoryMgr)){(function(){var a=SiebelApp.Offlineconstants;var f=SiebelJS.Dependency("SiebelApp.Constants");var c=SiebelApp.S_App.HistoryMgr;var b=SiebelJS.Dependency("SiebelApp.Utils");var g=SiebelApp.OfflineUtils;var h=a.get("IS_DYNAMIC");var e=a.get("LOG_EVT_CLIENT_SYS");var d=c.prototype.ProcessObjectInfo;c.prototype.ProcessObjectInfo=function(w){if(SiebelApp.OfflineAppSettings.GetMode()){var s;if(w.propArray.hasOwnProperty(h)){var o=SiebelApp.S_App.GetActiveView();var u=o.GetName();s=o.GetDefn();var l,q,t,j;var n=b.IsTrue(s.AddToHistory);if(n){var p="";if(b.IsEmpty(s.ThreadTitle)){if(!b.IsEmpty(s.ViewTitle)){p=s.ViewTitle}else{p=s.ViewbarText}}else{p=s.ThreadTitle
}if(!b.IsEmpty(s.ThreadApplet)&&!b.IsEmpty(s.ThreadField)){l=o.GetAppletMap()[s.ThreadApplet];q=(l)?l.GetBusComp():undefined;t=(q)?q.FindWorkSet(q.GetActiveRow()):undefined;j=(t)?t[g.RemoveNonAlphaChars(s.ThreadField)]:undefined;if(j){p+=": "+j}}w.SetProperty("n",p);var r;var v;if(w.propArray.hasOwnProperty("hnurl")){r=w.GetProperty("hnurl");var k=r;var m=b.DecodeFromQueryString(r);var i;m.SetProperty("SWECmd",a.get("GOTOVIEW"));m.SetProperty("SWEView",URLEncode(u));if(l&&t){i=unescape(l.GetName());m.SetProperty("SWEApplet0",URLEncode(i));m.SetProperty("SWERowId0",t.Id)}r=SiebelApp.S_App.GetPageURL()+f.get("SWE_ARG_START")+b.EncodeToQueryString(m,false);w.SetProperty("hnurl",HtmlEncode(r));m.SetProperty("SWECmd",a.get("GOTOBOOKMARKVIEW"));m.SetProperty("SWEBMC","");v='App().GotoView("'+u+'", "", "';v+=SiebelApp.S_App.GetPageURL()+f.get("SWE_ARG_START")+b.EncodeToQueryString(m,false);v+='",_sweclient._swecontent._sweview)';w.SetProperty("hnact",HtmlEncode(v));g.CcfLogEvent([e,100,5,100,v]);return d.call(this,w)}}}}else{return d.call(this,w)}}}())};