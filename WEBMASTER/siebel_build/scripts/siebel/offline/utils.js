/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2014
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 8.1.1.14SIA[23044]PATCHSET12 */
if(typeof(SiebelApp.OfflineUtils)==="undefined"){SiebelJS.Namespace("SiebelApp.OfflineUtils");SiebelApp.OfflineUtils=(function(){var p=SiebelAppFacade.FacadeConstants;var z=SiebelApp.OfflineCacheConfig;var l=SiebelApp.Offlineconstants;var q=p.get("WEB_DB");var e=p.get("LOCAL_STORAGE");var a=window.localStorage;var s=SiebelApp.Utils;var i=SiebelApp.Constants;var c=l.get("ALL");var j=l.get("METADATA_EX");var o=l.get("LOG_EVT_METADATA_EX");var m=l.get("DATA_EX_BASIC");var v=l.get("LOG_EVT_DATA_EX_BASIC");var n=l.get("DATA_EX_DETAILED");var t=l.get("LOG_EVT_DATA_EX_DETAILED");var k=l.get("UPSYNC");var r=l.get("LOG_EVT_UPSYNC");var h=l.get("CLIENT_SYS");var d=l.get("LOG_EVT_CLIENT_SYS");var y=l.get("LOG_EVT_COMMON");var g=l.get("DM_LOG_CHAR_LIMIT");var u=l.get("DM_LOG_RECORD_COUNT");function w(){var A;this.m_mapTimer={};B=function B(){return A};B.prototype=this;A=new B();A.constructor=B;return A}var x=new w();w.prototype.RefreshPage=function(){window.location.reload()};w.prototype.GetBrowserStorage=function(D){var C=window.localStorage.getItem("isAdfmContainer");var B=window.localStorage.getItem("isCompatibility");var A={};switch(D){case q:if(window.openDatabase){if((C==1)&&(B&&B=="false")){A=SiebelApp.SQLDBCALLER}else{A=SiebelApp.WebDB}}break;case e:A=SiebelApp.BrowserLocalStorage;break;default:if(window.openDatabase){if((C==1)&&(B&&B=="false")){A=SiebelApp.SQLDBCALLER}else{A=SiebelApp.WebDB}}else{A=SiebelApp.BrowserLocalStorage}break}return A};w.prototype.GetOfflineCacheConfig=function(E){var D={};D.dbName=z.get("OFFLINE_CACHE_DB_NAME");D.version=z.get("OFFLINE_CACHE_DB_VERSION");D.displayName=z.get("OFFLINE_CACHE_DB_DISP_NAME");D.maxSize=z.get("OFFLINE_CACHE_DB_MAXSIZE");D.tables=[z.get("REACTIVE_CACHE_TBL"),z.get("PRO_SYNCQUEUE_DB_TBL"),z.get("PRO_METADATASTORE_DB_TBL"),z.get("PRO_DB_PICKAPPLET_INFO_TBL"),z.get("PRO_DB_PICKFLD_MAP_TBL")];D.columns={};var B=z.get("REACTIVE_CACHE_TBL_COLS");D.columns[z.get("REACTIVE_CACHE_TBL")]=[];for(var H in B){if(B[H]){D.columns[z.get("REACTIVE_CACHE_TBL")].push(B[H])}}var G=z.get("PRO_SYNCQUEUE_DB_TBL_COLS");D.columns[z.get("PRO_SYNCQUEUE_DB_TBL")]=[];for(var A in G){if(G[A]){D.columns[z.get("PRO_SYNCQUEUE_DB_TBL")].push(G[A])}}var F=z.get("PRO_METADATASTORE_DB_TBL_COLS");var C="";D.columns[z.get("PRO_METADATASTORE_DB_TBL")]=[];for(C in F){if(F[C]){D.columns[z.get("PRO_METADATASTORE_DB_TBL")].push(F[C])}}F=z.get("PRO_DB_PICKAPPLET_INFO_TBL_COLS");D.columns[z.get("PRO_DB_PICKAPPLET_INFO_TBL")]=[];for(C in F){if(F[C]){D.columns[z.get("PRO_DB_PICKAPPLET_INFO_TBL")].push(F[C])}}F=z.get("PRO_DB_PICKFLD_MAP_TBL_COLS");D.columns[z.get("PRO_DB_PICKFLD_MAP_TBL")]=[];for(C in F){if(F[C]){D.columns[z.get("PRO_DB_PICKFLD_MAP_TBL")].push(F[C])}}return D};w.prototype.IsValidServerResponse=function(C){if(C){var A=C.indexOf("<!DOCTYPE");if(A===0){var B=C.indexOf("manifest");if(B===-1){return false}}return true}else{return false}};w.prototype.RemoveNonAlphaChars=function(A){A=A.replace(/\W/g,"");return A};w.prototype.eliminateDuplicates=function(B){var D,A=B.length;var C=[];var E={};for(D=0;D<A;D++){E[B[D]]=0}for(D in E){C.push(D)}return C};w.prototype.GetLogMsg=function(D,E){var C=SiebelApp.S_App.Model.GetDMLogMsg(D);if(typeof C!=="string"){return C}var A=0;if(E){A=E.length}if(A>0){E[0]=SiebelApp.S_App.Model.GetDMClassName(E[0]);E[1]=SiebelApp.S_App.Model.GetDMMethodName(E[1]);var B="";for(var F=0;F<A;F++){B="%"+(F+1);C=C.replace(B,E[F])}}return C};w.prototype.CcfLogEvent=function(F){var C=a.getItem("LogEvt");var I=F.length;if((I<2)||!C){return}var B=F[0];var H=F[1];var L=false;if(s.IndexOf([C],c)!==-1){L=true}else{switch(B){case o:if(s.IndexOf([C],j)!==-1){L=true}break;case v:if(s.IndexOf([C],m)!==-1||s.IndexOf([C],n)!==-1){L=true}break;case t:if(s.IndexOf([C],n)!==-1){L=true}break;case r:if(s.IndexOf([C],k)!==-1){L=true}break;case d:if(s.IndexOf([C],h)!==-1){L=true}break;case y:L=true;break}}if(L){var D={},E="AllLogs",K=parseInt(a.getItem("LogRecordNum")||0,10),G=E+(K||""),A=a.getItem(G)||"[]";D.c=H;F.splice(0,2);D.p=F;try{I=A.length;if(I<g){A=JSON.parse(A)}else{A=[];K=K?++K:1;a.setItem("LogRecordNum",K);G=E+(K||"")}A.push(D);a.setItem(G,JSON.stringify(A))}catch(J){SiebelJS.Log("Can not log more data as quota exceed, local store is full!")}}};w.prototype.StartTime=function(B){var A=new Date().getTime();b.call(this,B,A)};w.prototype.EndTime=function(E){var C;var A;var D;C=f.call(this,E);A=new Date().getTime();D=A-C;delete this.m_mapTimer[E];var B=E+"..."+D+"...milliseconds ";this.CcfLogEvent([y,27,15,95,B])};function b(B,A){this.m_mapTimer[B]=A}function f(A){return this.m_mapTimer[A]}w.prototype.GetPreference=function(E,D){var B=SiebelApp.S_App.NewPropertySet();B.SetProperty("Category",E);B.SetProperty("Name",D);B.SetProperty("Type","DM_LOG_EVTS");var H={};H.async=false;H.selfbusy=true;H.scope=this;H.opdecode=true;H.mask=true;var J=B.EncodeAsString();var G=CCFMiscUtil_CreatePropSet();var I=I||CCFMiscUtil_CreatePropSet();if(B.GetProperty(i.get("SWE_BUSINESS_SERVICE"))===i.get("SWE_NUMERIC_TRUE")){G.SetProperty(i.get("SWE_BUSINESS_SERVICE"),i.get("SWE_NUMERIC_TRUE"))}G.SetProperty(i.get("SWE_CMD_ARG"),i.get("SWE_CMD_INVOKE_METHOD_STR"));G.SetProperty(i.get("SWE_SERVICE"),"Web Engine UI Preferences");G.SetProperty(i.get("SWE_METHOD_STR"),"GetUserPreference");G.SetProperty(i.get("SWE_INPUT_PS"),J);SiebelApp.S_App.SetDefaultArgs(G);var C=s.EncodeToQueryString(G),F=new Date(),A=null;C=C+"&"+i.get("SWE_TIME_STAMP")+"="+F.getTime();A={url:SiebelApp.S_App.GetPageURL(),data:C.split(" ").join("%20"),type:"POST",async:false,contentType:"application/x-www-form-urlencoded",successfncallback:this.OnSuccessCallServer,errfncb:SiebelApp.S_App.OnFailureCallServer,context:{scope:SiebelApp.S_App,lp:H,outputPS:I,nPR:true}};SiebelApp.AjaxRequestMgr.Ajax(A);B=null};w.prototype.OnSuccessCallServer=function(D,A,G){var I=CCFMiscUtil_CreatePropSet();I.DecodeFromString(D);var C=I.GetProperty(i.get("SWE_RPC_PROP_RETURN_STATUS"));if(I.GetProperty("Status")!==i.get("SWE_RPC_PROP_STATUS_ERROR")){var E=I.GetChildCount();for(var B=0;B<E;B++){var F=I.GetChild(B);if(F!==null&&F.GetType()==="ResultSet"){var H=F.GetProperty(l.get("LIC_VALUE"));a.setItem("LogEvt",H)}}}else{I.SetPropertyStr(l.get("STATUS"),l.get("ACTION_RPC_COMPLETED"));D=I.EncodeAsString()}SiebelApp.S_App.OnSuccessCallServer.call(this,D,A,G)};w.prototype.Log=function(B){var A=false;if(IsOfflineModeEnabled()&&A){SiebelJS.Log(B+" "+SiebelApp.OfflineUtils.GetTS())}};w.prototype.GetRequestParam=function(B,D){var E="";var A=-1;A=B.indexOf(D);if(A!==-1){var C=B.substring(A,B.length);if(C.indexOf("&")===-1){C=C.substring(C.indexOf("=")+1,C.length)}else{C=C.substring(D.length,C.indexOf("&"))}E=C.replace(/%20/g," ")}return E};w.prototype.GetTS=function(){var B=new Date();var H=B.getMonth()+1;var A=B.getDate();var E=B.getFullYear();var G=("0"+H).slice(-2)+"/"+("0"+A).slice(-2)+"/"+E;var C=B.getHours();var F=B.getMinutes();var D=B.getSeconds();G+=" "+("0"+C).slice(-2)+":"+("0"+F).slice(-2)+":"+("0"+D).slice(-2)+" ";return G};w.prototype.ToTS=function(C,D){if(!C){return""
}var B;if(D===true){var J=C.getTime()+(C.getTimezoneOffset()*60000);B=new Date(J)}else{B=C}var F=B.getMonth()+1;var I=B.getDate();var H=B.getFullYear();var G=("0"+F).slice(-2)+"/"+("0"+I).slice(-2)+"/"+H;var K=B.getHours();var A=B.getMinutes();var E=B.getSeconds();G+=" "+("0"+K).slice(-2)+":"+("0"+A).slice(-2)+":"+("0"+E).slice(-2);return G};w.prototype.UtcToLocal=function(A){if(!A){return null}var B=new Date(A+" UTC");return B};w.prototype.GetToday=function(){var B=new Date();var H=B.getMonth()+1;var A=B.getDate();var E=B.getFullYear();var G=H+"/"+A+"/"+E;var C=0;var F=0;var D=0;G+=" "+("0"+C).slice(-2)+":"+("0"+F).slice(-2)+":"+("0"+D).slice(-2)+" ";return G};w.prototype.GetDate=function(){var B=new Date();var E=B.getMonth()+1;var A=B.getDate();var C=B.getFullYear();var D=E+"/"+A+"/"+C;return D};w.prototype.RTrim=function(A,B){if(A===undefined||B===undefined){return""}if(A.substring((A.length-B.length),(A.length))===B){A=A.substring(0,(A.length-(B.length)))}return A};w.prototype.StripQuotes=function(B){var A;A=B.charAt(0);if((A==='"'||A==="'")&&(B.length>1&&B.charAt(B.length-1)===A)){B=B.substring(1,(B.length-1))}return B};w.prototype.NotifyValueArray=function(F){var C=F;var E="";var B=F.length;for(var D=0;D<B;D++){var A=F[D].length;A=A.toString();E=E+A.concat("*",F[D])}return E};w.prototype.ProcessDPS=function(E,B,A,D,F){if(!D){D=A.length}for(var C=0;C<D;C++){var G=B.GetProperty(A[C]);if(!SiebelApp.Utils.IsEmpty(G)){if(F){E.SetPropertyStr(A[C],G)}else{E.SetPropertyStr(A[C],G);B.RemoveProperty(A[C])}}}};w.prototype.GetDate=function(){var B=new Date();var E=B.getMonth()+1;var A=B.getDate();var C=B.getFullYear();var D=E+"/"+A+"/"+C;return D};w.prototype.ConverttoUTCDate=function(G){var I;var D=+G.substring(0,2);var A=+G.substring(3,5);var F=+G.substring(6,10);var H=+G.substring(11,13);var B=+G.substring(14,16);var C=+G.substring(17,19);var E=G.substring(20,22);I=new SiebelApp.S_App.DatumUTCDateTimeObject();I.SetDateTime(F,D,A,H,B,C);return I};w.prototype.JsonRecordSet=function(A){var B=SiebelJS.Dependency("SiebelApp.Utils").DecodeFromQueryString(A);var E={};E.Request=A;E.RecordSet={};E.FieldValue=[];E.SweCommands={};var G;var D;var F;for(var C=true;(F=B.EnumProperties(C))!==null;C=false){if(F.search("OF_")!==-1){G=F.split("OF_")[1];D=unescape(B.GetPropertyAsStr(F));E.RecordSet[G]=D;E.FieldValue.push([G,D])}else{E.SweCommands[F]=unescape(B.GetPropertyAsStr(F))}}return E};w.prototype.GetTempId=function(){var B=((new Date()).getTime());B=(B).toString(36);if(B.length>6){B=B.substring(B.length-6)}var C=(Math.round((Math.random()*46655))).toString(36);var A=(Math.round((Math.random()*46655))).toString(36);var D=(B.concat(":",C,A)).toUpperCase();return D};w.prototype.GetTempRowId=function(){var B=((new Date()).getTime());B=(B).toString(36);var A=Math.floor(Math.random()*5);if(B.length>6){B=B.substring(B.length-6);B=B.substring(0,A).concat(B.substring(A+1,6))}var C=(Math.round((Math.random()*46655))).toString(36);var D=(C.concat("-",B)).toUpperCase();return D};w.prototype.Truncate=function(B,A){if(!B){return""}B=String(B);return B.length>A?B.slice(0,A)+"...":B};w.prototype.TimerFactory=function(H,C){C=C||{};var B=C.interval||60*1000;var G=C.timeout||30*60*1000;var D=C.onTimeout||function(){};var E,J;function I(){if(J){return}J=setTimeout(function(){F();D()},G)}function A(){if(E){return}E=setInterval(H,B);if(J){clearTimeout(J)}I()}function F(){clearInterval(E);E=null;clearTimeout(J);J=null}A();return{start:A,stop:F,restart:function(){F();A()},isRunning:function(){return !!E}}};w.prototype.DefineExtentions=function(D,B,A){for(var C in B){if(B.hasOwnProperty(C)){(function(){var F=B[C];var E=A[C];D.prototype[C]=function(){if(SiebelApp.S_App.GetOfflineMode()){return(F.apply(this,arguments))}else{return(E.apply(this,arguments))}}}())}}};return x}())};