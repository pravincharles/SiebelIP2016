/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2014
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 8.1.1.14SIA[23044]PATCHSET7 */
if(typeof(SiebelAppFacade.CalGanttRenderer)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.CalGanttRenderer");define("siebel/calganttrenderer",["siebel/ganttrenderer"],function(){SiebelAppFacade.CalGanttRenderer=(function(){var c=SiebelJS.Dependency("SiebelApp.Constants"),h=c.get("SWE_GANTT_DRILLDOWN_CLS"),f=c.get("SWE_GANTT_ACTIVITY_LABEL"),k=c.get("SWE_GANTT_TIME_SCALE"),a="MM/dd/yyyy",g=c.get("SWE_GANTT_STARTMILLIS"),e=c.get("SWE_GANTT_ENDMILLIS"),j=c.get("SWE_GANTT_START_DATE"),i=c.get("SWE_GANTT_ACTIVITY_START_TIME"),d="GCD";function l(){SiebelAppFacade.CalGanttRenderer.superclass.constructor.apply(this,arguments)}SiebelJS.Extend(l,SiebelAppFacade.GanttRenderer);l.prototype.Init=function(){var m=this.GetPM();this.AttachPMBinding("RefreshData",function(){if(m.Get("IsRefreshNeeded")===true){m.SetProperty("InEvent",true)}});this.AttachPMBinding("NotifyTSButtonClk",function(){m.SetProperty("IsRefreshNeeded",false)});SiebelAppFacade.CalGanttRenderer.superclass.Init.call(this)};l.prototype.ShowUI=function(){this.setGanttCtrlHeight(this.getGanttCtrlHeight()/2);SiebelAppFacade.CalGanttRenderer.superclass.ShowUI.call(this)};l.prototype.BindData=function(){var n=this.GetPM();if(n.Get(d)==="Working Hours"){n.SetProperty("isDispatchBoard","TRUE")}SiebelAppFacade.CalGanttRenderer.superclass.BindData.call(this);var q=n.Get("RecordSet");var r=n.Get("Resource Id");var o=n.Get("ResIDtoIndex");var p=o?o[r]:0;var m=q?q[p]:0;if(m){b.call(this)}$("#s_"+this.GetAppletId()+"_div").find(".siebui-ganttHead2").find(".siebui-ganttInnerTbl").find("div").addClass("siebui-gantt-align-left")};l.prototype.BindEvents=function(){SiebelAppFacade.CalGanttRenderer.superclass.BindEvents.call(this);var m=$("#s_"+this.GetAppletId()+"_div");m.on("click",(".siebui-taskEditUtility"),{ctx:this},b).on("click",(".siebui-taskEditRow"),{ctx:this},b).off("dblclick",(".siebui-taskEditUtility"))};l.prototype.calcNonContiguousTime=function(u){var r=this.GetPM();var B=r.Get(k);if((B==="1")||(B==="64")||(B==="4")||(B==="512")||(B==="1024")||(B==="2048")||(B==="4096")){var s=r.Get("PixelsPerUnit"),x=r.Get("TDays"),y=r.Get("StartTime"),v=r.Get("EndTime"),m=0,p=0;var q,z,w,o;var n=new Date(r.Get(g));var A=r.Get("FinalWeekDays");q=s*$("#s_"+this.GetAppletId()+"_div").find("#UGrid").width();if(q){p=parseInt(u/q,10)}for(var t=0;t<p;){if(A.indexOf(n.getDay())!==-1){t++}m++;n.setDate(n.getDate()+1)}while(A.indexOf(n.getDay())===-1){m++;n.setDate(n.getDate()+1)}z=u%q;w=r.Get(g)+m*x;if(q){o=parseInt(r.Get("StartTime")+z/q*r.Get("AxisDuration"),10)}w=w+o;return parseInt(w,10)}else{return(SiebelAppFacade.CalGanttRenderer.superclass.calcNonContiguousTime.call(this,u))}};l.prototype.SetHScrollPos=function(){var p=this.GetPM(),s=new Date(p.Get(j)),u=p.Get("SelectedEvent"),n,m=0,t=3600000,o,q,r;if(u){n=new Date(u.ST);if(n.toDateString()===s.toDateString()){q=3*t/p.Get("Scale_factor");p.ExecuteMethod("setHoursFrom",s,String(p.Get(i)));o=(n.getTime()-s.getTime())%(24*t);o-=q;s=new Date(p.Get(j));s.setHours(0,0,0);r=o*p.Get("PixelsPerUnit")/p.Get("AxisDuration");m+=r;m+=(s.getTime()-p.Get(g))/(p.Get(e)-p.Get(g));m+=m*p.Get("MinGanttsize");$(".siebui-splitBox3").scrollLeft(m);return true}}SiebelAppFacade.CalGanttRenderer.superclass.SetHScrollPos.call(this)};l.prototype.preparerowtasks=function(B,p,u){var y="",m=u.EventColor,D=u.Statabb,q=u.configSpacePatternFlag,v,n,x,z,r,o,t,C,s="",A,w="siebui-layout";if(u.TST==="64"){w+=" siebui-taskBoxMonthDay"}if(B){for(z in B){if(B.hasOwnProperty(z)){A=B[z];v=A[D];n=D+"_"+v;s="";if(A.BT&&(A.BT==="Out of Order"||A.BT==="Unavailable Instance"||A.BT==="Ineffective UNCHANGED")){n="GS_LIC_"+A.BT}if(A.CR){s+=" siebui-calgantt-currentTask";this.GetPM().SetProperty("SelectedEvent",A);x="";if(A.RSZ==="Y"){A.height=A.height*this.GetPM().Get("RecordSet").length}}else{if(m){x=m[n]}if(!x){x=u.EventDefaultColor}}r=B[z][f];if(A.OLPCNT&&A.OLPCNT>2){r="";if(A.Icon){A.Icon=""}}if(!r){r=""}o=A.DDID;if(!o){o="";t=""}else{t=h}if(v.trim()!==""){s+=" siebui-calgantt-"+v.replace(/\s+/g,"").trim()}C=100-(A.SW?parseInt(A.SW,10):0)-(A.TW?parseInt(A.TW,10):0)-5;if(A.CR&&A.RSZ==="Y"){y=y+'<div class="siebui-taskBox '+A.CLS+'" taskId='+A.ID+"  id= "+p.toString()+" style=width:"+A.width+"%;height:"+A.height+"px;left:"+A.left+"%;margin-top:"+A.top+'px;top:0px; ot = "div" rn = "event-'+A.ID+'" un = "event-'+A.ID+'"><div class="'+w+s+'" style=background-color:'+x+";>"}else{y=y+'<div class="siebui-taskBox '+A.CLS+'" taskId='+A.ID+"  id= "+p.toString()+" style=width:"+A.width+"%;height:"+A.height+"px;left:"+A.left+"%;margin-top:"+A.top+'px; ot = "div" rn = "event-'+A.ID+'" un = "event-'+A.ID+'"><div class="'+w+s+'" style=background-color:'+x+";>"}if(A.SW){y=y+'<div class = "siebui-turnTime siebui-setupTime" style = width:'+A.SW+"%;></div>"}if(A.TW){y=y+'<div class = "siebui-turnTime siebui-teardownTime" style = width:'+A.TW+"%;></div>"}if(q==="Y"&&A.CFST&&A.CFST==="Y"){y=y+'<div class = "siebui-configSpacePattern">'}y=y+'<span class="siebui-taskStatus" style = width:'+C+"%; status="+A.GS+">"+this.createIconInfo(A)+'<a class="siebui-activityLabel '+t+'" data-drilldown-type= "UGrid" data-drilldown-id="'+o+'" ot = "a" rn = "'+r+'" un = "'+r+'">'+r+"</a></span>";y=y+"</div></div>";if(q==="Y"&&A.CFST&&A.CFST==="Y"){y=y+"</div>"}}}}return y};function b(q){var p=q?q.data.ctx:this,m=p.GetPM();var o=m.Get("Resource Id");var n=m.Get("ResIDtoIndex");var r=n[o]||0;if(r===m.Get("SelectedRow")){return true}SiebelApp.S_App.uiStatus.Busy({});m.SetProperty("SelectedRow",r);if(!m.OnControlEvent(c.get("PHYEVENT_SELECT_ROW"),r,false,false)){SiebelApp.S_App.uiStatus.Free();return false}SiebelApp.S_App.uiStatus.Free();return true}return l}());return"SiebelAppFacade.CalGanttRenderer"})};