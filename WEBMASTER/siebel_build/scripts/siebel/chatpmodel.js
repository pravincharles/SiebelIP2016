/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2014
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 8.1.1.14SIA[23044]PATCHSET7 */
if(typeof(SiebelAppFacade.ChatPresentationModel)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.ChatPresentationModel");define("siebel/chatpmodel",["siebel/pmodel"],function(){SiebelAppFacade.ChatPresentationModel=(function(){var s=SiebelJS.Dependency("SiebelApp.Constants");var C=SiebelJS.Dependency("SiebelApp.Utils");var d=3000;var o=3;var A=["INFO: ","ERROR: ","WARNING: ","DEBUG: "];function e(){SiebelAppFacade.ChatPresentationModel.superclass.constructor.call(this,{GetName:function(){return"ChatObject"}})}SiebelJS.Extend(e,SiebelAppFacade.BasePM);e.prototype.Init=function(){this.AddProperty("ChatSysPref",{bEnableBlinkTab:false,nCustomerTypeDisplayTime:d,nAgentTypeDetectInterval:d});this.AddProperty("ChatTabMap",{});this.AddProperty("CurrentChat",null);this.AddProperty("CurrentTabOnHold",null);this.AddProperty("NewChatMessage",null);this.AddProperty("ShowTypingMsg",null);this.AddProperty("ChatIdRemoved",null);this.AddProperty("ChatUpdated",null);this.AddProperty("ChatIdHold",null);this.AddProperty("ChatResumed",null);this.AddProperty("ChatClearLog",null);this.AddProperty("TextInput4Set",null);this.AddProperty("UrlInput4Set",null);this.AddProperty("ReadLastMessage",null);this.AddProperty("SetFocus",null);this.AddProperty("TextAreaToBeFocusedId",null);this.AddProperty("ChatConfigPS",null);this.AddProperty("UpdateDashboard",null);this.AddProperty("UpdateSmartShare",null);this.AddProperty("UpdateFrequentlyUsedText",null);this.AddProperty("UpdatePushUrl",null);this.AddProperty("UpdateKBVisited",null);this.AddProperty("ChatSetFocusEventList",null);this.AddProperty("SwitchDisabled",false);this.AddProperty("SwitchTimer",null);this.AddProperty("RestoreScreenEnabled",true);this.AddMethod("InvokeServiceMethod",function(J,K,L){var I=SiebelApp.S_App.GetService(s.get("NAME_CHATUISVC"));if(I){q(3,"Open UI - Chat: Invoke Chat UI Business Service Method: "+J);if(!K){K=CCFMiscUtil_CreatePropSet()}K.SetPropertyStr(s.get("CHATUISVC_TAG_METHOD"),J);L=I.InvokeMethod(J,K);if(L){var N=L.GetChildByType(s.get("CHATCC_PROPSET_TYPE_RESULT"));if(N){var M=N.GetProperty(s.get("CHATUISVC_TAG_METHOD"));if(M){F.call(this,M,N)}}}}else{q(1,"Open UI - Chat: Chat UI Business Service Not Found!")}});this.AddMethod("GetCurrChatId",function(){var I=this.Get("CurrentChat");return I?I.Id:""});this.AddMethod("AgentTyping",function(I){var J=this.Get("ChatTabMap")[I];if(J){if((new Date().getTime()-J.agentTypingSentTime)>=this.Get("ChatSysPref").nAgentTypeDetectInterval){J.agentTypingSentTime=new Date().getTime();var K=CCFMiscUtil_CreatePropSet();K.SetProperty(s.get("CHATUISVC_TAG_CURRCHATID"),I);K.SetPropertyStr("SWEBS","1");this.ExecuteMethod("InvokeServiceMethod",s.get("CHATUISVC_METHOD_SENDAGENTTYPINGMSG"),K)}}});this.AddMethod("SendMessage",function(J){if(J&&J.chatId&&J.text){var K=CCFMiscUtil_CreatePropSet(),L,I;if(J.isUrl){L=s.get("CHATCC_METADATA_CTRLNAME_URL");I=s.get("CHATUISVC_METHOD_PUSHURL")}else{L=s.get("CHATCC_METADATA_CTRLNAME_TEXT");I=s.get("CHATUISVC_METHOD_SENDMESSAGE")}K.SetProperty(s.get("CHATUISVC_TAG_CURRCHATID"),J.chatId);K.SetProperty(L,J.text);this.ExecuteMethod("InvokeServiceMethod",I,K)}});this.AddMethod("ImplicitSave",function(){return n()});this.AddMethod("SwitchChat",function(J,I){H.call(this,J,I)});this.AddMethod("LoadChatData",function(){f.call(this)});this.AddMethod("HoldTab",function(I){D.call(this,I)});this.AddMethod("GetTextInputValue",function(){v.call(this)});this.AddMethod("GetUrlInputValue",function(){B.call(this)});this.AddMethod("LogMsg",function(J,I){a.call(this,J,I)});this.AddMethod("CloseChatPane",function(){l.call(this)});this.AddMethod("SetFocus",function(){this.SetProperty("SetFocus",true)});this.AddMethod("SetFocusToTextInput",function(){this.SetProperty("SetFocusToTextInput",true)});this.AttachEventHandler(s.get("CHAT_PANE_CLOSE"),function(){l.call(this);SiebelApp.S_App.UnregisterExtObject("ChatPane")})};function k(){this.SetProperty("ChatSysPref",{bEnableBlinkTab:false,nCustomerTypeDisplayTime:d,nAgentTypeDetectInterval:d});this.SetProperty("ChatTabMap",{});this.SetProperty("CurrentChat",null);this.SetProperty("CurrentTabOnHold",null);this.SetProperty("NewChatMessage",null);this.SetProperty("ShowTypingMsg",null);this.SetProperty("ChatIdRemoved",null);this.SetProperty("ChatUpdated",null);this.SetProperty("ChatIdHold",null);this.SetProperty("ChatResumed",null);this.SetProperty("ChatClearLog",null);this.SetProperty("TextInput4Set",null);this.SetProperty("UrlInput4Set",null);this.SetProperty("SetFocus",null);this.SetProperty("TextAreaToBeFocusedId",null);this.SetProperty("ChatSetFocusEventList",null);this.SetProperty("SwitchDisabled",false);this.SetProperty("SwitchTimer",null);this.SetProperty("RestoreScreenEnabled",true)}e.prototype.Setup=function(I){I.SetProperty("SWE_OUI_RENDERER","ChatPhyRenderer");SiebelAppFacade.ChatPresentationModel.superclass.Setup.call(this,I);r.call(this,I)};e.prototype.HandleNotify=function(I){this.AddProperty("LocaleInfo",{});r.call(this,I)};e.prototype.Notify=function(J){var I=this;J.each(function(){var K=CCFMiscUtil_CreatePropSet();K.DecodeFromString($(this).text());var L=K.GetProperty(s.get("CHATUISVC_TAG_EVENT"));F.call(I,L,K)})};function F(J,X){var O;var ac=J.toUpperCase();var V,R=0;if(!X||X.IsEmpty()){return}switch(J){case s.get("CHATUISVC_METHOD_INITIALIZEAX"):var U=X.GetPropertyAsStr(s.get("CHATUISVC_TAG_ENABLE_BLINKTAB"));var Q=X.GetPropertyAsStr(s.get("CHATUISVC_TAG_TYPEDISTIME"));var Z=X.GetPropertyAsStr(s.get("CHATUISVC_TAG_TYPEDECINTERVAL"));var S=X.GetPropertyAsStr(s.get("CHATUISVC_TAG_ENABLE_RESTORESCREEN"));if(S===s.get("CHATUISVC_VALUE_NO")){this.SetProperty("RestoreScreenEnabled",false)}var N=this.Get("ChatSysPref");var Y=X.GetPropertyAsStr("ChatSetFocusEventList");this.SetProperty("ChatSetFocusEventList",w(Y));var M;if(U&&U===s.get("CHATUISVC_VALUE_YES")){N.bEnableBlinkTab=true}if(Q){M=parseInt(Q,10);if(M>0){N.nCustomerTypeDisplayTime=M*1000}}if(Z){M=parseInt(Z,10);if(M>0){N.nAgentTypeDetectInterval=M*1000}}var I=CCFMiscUtil_CreatePropSet();I.DecodeFromString(X.GetPropertyAsStr(s.get("CHATUISVC_TAG_METADATA")));this.SetProperty("ChatConfigPS",I);var W=CCFMiscUtil_CreatePropSet();W.SetProperty(s.get("CHATUISVC_TAG_NEEDTYPEINFO"),"TRUE");this.ExecuteMethod("InvokeServiceMethod",s.get("CHATUISVC_METHOD_UPDATECHATDATA"),W);break;case s.get("CHATUISVC_METHOD_UPDATECHATDATA"):m.call(this,X);break;case s.get("CHATUISVC_METHOD_GETFIELDDATA"):j.call(this,X);break;case s.get("CHATUISVC_METHOD_GETSMARTSHARETEXT"):var aa=X.GetPropertyAsStr(s.get("CHATUISVC_TAG_DATA_FIELD"));if(aa&&aa.length>0){this.SetProperty("UpdateSmartShare",aa)}break;case s.get("CHATUISVC_EVENT_ENDCHAT"):case s.get("CHATUISVC_EVENT_WRAPUPCHAT"):g.call(this,X);var K=X.GetPropertyAsStr(s.get("CHATUISVC_TAG_EVENTCHATID"));if(K===this.ExecuteMethod("GetCurrChatId")){}break;case s.get("CHATUISVC_EVENT_NEWMESSAGEINACTIVE"):case s.get("CHATUISVC_EVENT_UPDATECHATDISPLAYNAME"):case s.get("CHATUISVC_EVENT_ACCEPTCHATHOLD"):g.call(this,X);break;case s.get("CHATUISVC_EVENT_HOLDCHAT"):z.call(this,X);
break;case s.get("CHATUISVC_EVENT_ACCEPTCHAT"):case s.get("CHATUISVC_EVENT_RESUMECHAT"):t.call(this,J,X);break;case s.get("CHATUISVC_EVENT_NEWMESSAGE"):E.call(this,X);break;case s.get("CHATUISVC_EVENT_UPDATEDATAFIELD"):var ab=X.GetPropertyAsStr(s.get("CHATUISVC_TAG_CURRCHATID"));if(ab!==this.ExecuteMethod("GetCurrChatId")){q(1,"Current chat id does not match!")}var W=X.Clone();this.ExecuteMethod("InvokeServiceMethod",s.get("CHATUISVC_METHOD_GETFIELDDATA"),W);break;case s.get("CHATUISVC_METHOD_REFRESHCHATPANEDASHBOARD"):var T=X.GetPropertyAsStr(s.get("CHATUISVC_TAG_CURRCHATID"));if(T!==this.ExecuteMethod("GetCurrChatId")){q(1,"Current chat id does not match!")}G.call(this,X);var L=this.Get("ChatTabMap")[T];if(L){this.SetProperty("UpdateDashboard",L)}break;case s.get("CHATUISVC_EVENT_SHOWTYPINGMSG"):x.call(this,X);break;case s.get("CHATUISVC_EVENT_SWITCHDONE"):if(this.Get("SwitchDisabled")){this.SetProperty("SwitchDisabled",false)}var P=this.Get("SwitchTimer");if(P!==null){clearTimeout(P);this.SetProperty("SwitchTimer",null)}break;default:break}O=this.Get("ChatSetFocusEventList");R=O.length;for(V=0;V<R;V++){if(ac===O[V]){this.ExecuteMethod("SetFocus");break}}}function w(J){var I=[];var L=0;var K=0;J=J.replace(/\s+/g,"");if(J.length>0){var M=J.toUpperCase();I=M.split(";");K=I.length;for(L=0;L<K;L++){if(I[L].length===0){I.splice(L,1)}}}else{I.push(s.get("CHATUISVC_METHOD_INITIALIZEAX").toUpperCase());I.push(s.get("CHATUISVC_EVENT_ACCEPTCHAT").toUpperCase());I.push(s.get("CHATUISVC_EVENT_RESUMECHAT").toUpperCase())}return I}function j(J){var O=J.GetPropertyAsStr(s.get("CHATUISVC_TAG_DATA_FIELD"));var I=J.GetPropertyAsStr(s.get("CHATUISVC_TAG_APPEND"));switch(O){case s.get("CHATUISVC_TAG_TRANSCRIPT"):var M=J.GetProperty(s.get("CHATUISVC_TAG_TRANSCRIPT"));h.call(this,M);break;case s.get("CHATCC_METADATA_CTRLNAME_TEXT"):var N=J.GetProperty(s.get("CHATCC_METADATA_CTRLNAME_TEXT"));this.SetProperty("UpdateFrequentlyUsedText",N);break;case s.get("CHATCC_METADATA_CTRLNAME_URL"):var K=J.GetProperty(s.get("CHATCC_METADATA_CTRLNAME_URL"));this.SetProperty("UpdatePushUrl",K);break;case s.get("CHATCC_METADATA_CTRLNAME_KB"):var L=J.GetProperty(s.get("CHATCC_METADATA_CTRLNAME_KB"));this.SetProperty("UpdateKBVisited",L);break;default:break}}function x(I){var J=I.GetPropertyAsStr(s.get("CHATUISVC_TAG_CURRCHATID"));if(J===this.ExecuteMethod("GetCurrChatId")){var K=this.Get("ChatTabMap")[J];if(K){this.SetProperty("ShowTypingMsg",K)}}}function t(K,J){var I=this.Get("CurrentChat");var N="";if(I&&y(I)){N=I.Id;D.call(this,N)}var L=J.GetPropertyAsStr(s.get("CHATUISVC_TAG_CURRCHATID"));var M=J.Clone();M.SetPropertyStr(s.get("CHATUISVC_TAG_EVENTCHATID"),L);if(K===s.get("CHATUISVC_EVENT_RESUMECHAT")&&L!==N){M.SetProperty(s.get("CHATUISVC_TAG_NEEDTYPEINFO"),"TRUE")}this.ExecuteMethod("InvokeServiceMethod",s.get("CHATUISVC_METHOD_UPDATECHATDATA"),M);p.call(this,L)}function g(I){var K=I.GetPropertyAsStr(s.get("CHATUISVC_TAG_CURRCHATID"));var J=I.GetPropertyAsStr(s.get("CHATUISVC_TAG_EVENTCHATID"));var L=I.Clone();var M=this.ExecuteMethod("GetCurrChatId");if(M){u.call(this,M,s.get("CHATCC_METADATA_CTRLNAME_TEXT"),L);u.call(this,M,s.get("CHATCC_METADATA_CTRLNAME_URL"),L)}if(J!==K){L.SetProperty(s.get("CHATUISVC_TAG_EVENTCHATID"),"")}this.ExecuteMethod("InvokeServiceMethod",s.get("CHATUISVC_METHOD_UPDATECHATDATA"),L)}function z(I){var J=I.GetPropertyAsStr(s.get("CHATUISVC_TAG_CURRCHATID"));var L=this.Get("CurrentChat");var K=I.Clone();if(J&&L&&L.Id===J){if(y(L)){K.SetProperty(s.get("CHATUISVC_TAG_EVENTCHATID"),J);this.ExecuteMethod("InvokeServiceMethod",s.get("CHATUISVC_METHOD_REMOVECHATDATA"),K)}else{u.call(this,J,s.get("CHATCC_METADATA_CTRLNAME_TEXT"),K);u.call(this,J,s.get("CHATCC_METADATA_CTRLNAME_URL"),K);this.ExecuteMethod("InvokeServiceMethod",s.get("CHATUISVC_METHOD_SAVEINPUTFIELDS"),K)}D.call(this,J)}}function H(K,I){q(3,"OnSwitchChat: "+K+", "+I);var J=CCFMiscUtil_CreatePropSet();J.SetPropertyStr(s.get("CHATUISVC_TAG_CURRCHATID"),K);J.SetPropertyStr(s.get("CHATUISVC_TAG_NEWSELECTEDCHATID"),I);this.ExecuteMethod("InvokeServiceMethod",s.get("CHATUISVC_METHOD_SWITCHCHAT"),J)}function h(O,P){var N=this.Get("CurrentChat");if(!N){return}var K=N.Id;var L=this.Get("ChatTabMap");var M=L[K];if(M){if(C.IsEmpty(P)){P=true}if(!P){this.SetProperty("ChatClearLog",{chatId:K})}var I=this,J=0;$($.parseXML(O)).find("message, pushurl, system-message").each(function(){J++;if(!P||J>M.transcriptCnt){var W=$(this).context.nodeName.toUpperCase(),T=$(this).attr("userName"),S=$(this).attr("timestamp"),R=($(this).attr("from")==="agent"),V=false,U=$.trim($(this).text());switch(W){case"MESSAGE":V=false;break;case"PUSHURL":V=true;R=true;break;case"SYSTEM-MESSAGE":T="System Message";R=true;V=false;break;default:return}var Q={chatId:K,userName:T,text:U,timestamp:S,isAgent:R,isUrl:V};I.SetProperty("NewChatMessage",Q)}});M.transcriptCnt=J;if(J>0){I.SetProperty("ReadLastMessage",K)}}}function r(J){var K;var I=J.GetChildCount();for(K=0;K<I;K++){var L=J.GetChild(K);if(L.GetType()===s.get("CHAT_PST_TYPE_LOCALE")){this.AddProperty("LocaleInfo",b.call(this,L))}}}function b(M){if(M.GetType()!==s.get("CHAT_PST_TYPE_LOCALE")){return}var L=true;var O;var J;var N={};var K;var I=M.GetPropertyCount();for(K=0;K<I;K++){if(L){O=M.GetFirstProperty();L=false}else{O=M.GetNextProperty()}J=M.GetProperty(O);if(O===s.get("CHAT_PANE_CAPTION")){N.CAPTION=J}}return N}function f(){k.call(this);this.ExecuteMethod("InvokeServiceMethod",s.get("CHATUISVC_METHOD_INITIALIZEAX"))}function m(Q){G.call(this,Q);var N=Q.GetProperty(s.get("CHATUISVC_TAG_TRANSCRIPT"));h.call(this,N,false);var O=Q.GetPropertyAsStr(s.get("CHATUISVC_TAG_CURRCHATID"));var K=this.Get("ChatTabMap")[O];if(K){this.SetProperty("UpdateDashboard",K)}var J=this.Get("CurrentChat");if(J){var M=J[s.get("CHATCC_METADATA_CTRLNAME_TEXT")];this.ExecuteMethod("GetTextInputValue",J.Id);var I=this.Get("TextInput4Get");if(!I){this.SetProperty("TextInput4Set",M)}var P=J[s.get("CHATCC_METADATA_CTRLNAME_URL")];this.ExecuteMethod("GetUrlInputValue",J.Id);var L=this.Get("UrlInput4Get");if(!L){this.SetProperty("UrlInput4Set",P)}}}function G(Q){if(!Q){return}var I=this.Get("ChatTabMap");var P=Q.GetProperty(s.get("CHATUISVC_TAG_CURRCHATID"));var O=Q.GetProperty(s.get("CHATUISVC_TAG_CURRCHATONHOLD"));var L=null;var K;var N=Q.GetChildCount();for(K=0;K<N;K++){L=Q.GetChild(K);if(L&&L.GetType()==="Tab"){var M=L.GetProperty(s.get("CHATUISVC_TAG_CHATID"));var J=I[M];if(!J){J={Id:M,agentTypingSentTime:0,transcriptCnt:0};I[M]=J}i(J,L);if(y(J)&&M!==P){c.call(this,M)}else{this.SetProperty("ChatUpdated",J)}if(M===P){this.SetProperty("CurrentChat",J);if(O&&!y(J)){D.call(this,M)}}}}this.SetProperty("ChatTabMap",I)}function i(N,J){var M=J.GetProperty(s.get("CHATUISVC_TAG_CAPTION"));var L=J.GetProperty(s.get("CHATUISVC_TAG_NEWMESSAGECOUNT"));var K=J.GetProperty(s.get("CHATUISVC_TAG_LASTMESSAGE"));var O=J.GetProperty(s.get("CHATUISVC_TAG_CHATSTATE"));N.state=O;N.caption=M;N.newMsgCnt=L;if(L>0){N.newMsg=K}var I=J.GetChildByType(s.get("CHATUISVC_TAG_TYPE_FIELD"));
if(I){var P=I.EnumProperties(true);do{N[P]=I.GetProperty(P)}while((P=I.EnumProperties(false)))}}function y(I){return(I.state===s.get("CHATUISVC_CHATSTATE_TERMINATE"))}function D(L,K){var M=this.Get("ChatTabMap")[L];if(!M){q(1,"Holding chat info not found!");return}var J=this.Get("CurrentTabOnHold");if(!J){this.SetProperty("CurrentTabOnHold",M);J=M;this.SetProperty("ChatIdHold",L)}var I=this.Get("CurrentChat");if(I!==J){q(1,"Holding chat is not current!");return}if(!K&&y(M)){c.call(this,L,true);this.SetProperty("CurrentTabOnHold",null);this.SetProperty("CurrentChat",null)}}function p(I){var J=this.Get("ChatTabMap")[I];if(!J){q(1,"Resuming chat info not found!");return}this.SetProperty("CurrentTabOnHold",null);this.SetProperty("CurrentChat",J);this.SetProperty("ChatResumed",J)}function c(J,I){if(J){this.SetProperty("ChatIdRemoved",J);var K=this.Get("ChatTabMap");if(K.hasOwnProperty(J)){delete K[J];if(!I){var L=CCFMiscUtil_CreatePropSet();L.SetProperty(s.get("CHATUISVC_TAG_EVENTCHATID"),J);this.ExecuteMethod("InvokeServiceMethod",s.get("CHATUISVC_METHOD_REMOVECHATDATA"),L)}}}}function E(I){var M=I.GetPropertyAsStr(s.get("CHATUISVC_TAG_CURRCHATID"));var K=this.Get("CurrentChat");if(!K){q(1,"Fatal error, current chat is invalid!");return}var L=K.Id;if(M!==L){q(1,"Current chat id does not match!")}var J=I.Clone();J.SetPropertyStr(s.get("CHATUISVC_TAG_DATA_FIELD"),s.get("CHATUISVC_TAG_TRANSCRIPT"));J.SetPropertyStr(s.get("CHATUISVC_TAG_APPEND"),s.get("CHATUISVC_VALUE_YES"));this.ExecuteMethod("InvokeServiceMethod",s.get("CHATUISVC_METHOD_GETFIELDDATA"),J)}function v(I){}function B(I){}function u(L,N,J,K){if(N===s.get("CHATCC_METADATA_CTRLNAME_TEXT")){this.ExecuteMethod("GetTextInputValue",L);var I=this.Get("TextInput4Get");J.SetPropertyStr(s.get("CHATCC_METADATA_CTRLNAME_TEXT"),I);if(K){this.SetProperty("TextInput4Set","")}}else{if(N===s.get("CHATCC_METADATA_CTRLNAME_URL")){this.ExecuteMethod("GetUrlInputValue",L);var M=this.Get("UrlInput4Get");J.SetPropertyStr(s.get("CHATCC_METADATA_CTRLNAME_URL"),M);if(K){this.SetProperty("UrlInput4Set","")}}}}function q(J,I){a(J,"chatpmodel.js: "+I)}function a(J,I){if(SiebelApp.S_App.CommToolbarUtil){SiebelApp.S_App.CommToolbarUtil.Log(J,I)}else{if(J<o){J=(J<A.length)?J:A.length-1;SiebelJS.Log("["+C.GetISODateTime(null,true)+"]: "+A[J]+I)}}}function l(){var I=CCFMiscUtil_CreatePropSet();I.SetProperty(s.get("SWE_VIEW_ID_STR"),s.get("CHAT_PANE_VIEWNAME"));I.SetPropertyStr("SWEBS","1");var J=this.ExecuteMethod("GetCurrChatId");if(J){u.call(this,J,s.get("CHATCC_METADATA_CTRLNAME_TEXT"),I);u.call(this,J,s.get("CHATCC_METADATA_CTRLNAME_URL"),I)}this.ExecuteMethod("InvokeServiceMethod",s.get("CHATUISVC_METHOD_TOGGLECHATPANE"),I)}function n(){var I=true;var L=App();if(L===undefined||L===null){q(2,"App() failed!");return I}var J=App().GetMainView();if(J===undefined||J===null){q(2,"No main view found!");return I}var K=J.GetActiveApplet();if(K===undefined||K===null){q(2,"No active applet found!");return I}I=K.InvokeMethod("ImplicitCommit",CCFMiscUtil_CreatePropSet());return I}return e}());return SiebelAppFacade.ChatPresentationModel})};