/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2014
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 8.1.1.14SIA[23044]PATCHSET9 */
if(typeof(SiebelAppFacade.JSTreeRenderer)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.JSTreeRenderer");define("siebel/jsTreeCtrl",["siebel/basephyrenderer"],function(){SiebelAppFacade.JSTreeRenderer=(function(){var h=SiebelJS.Dependency("SiebelApp.Constants"),f=h.get("SWE_SCREEN_NAV_CONTROL_STR"),g=h.get("SWE_AGGR_VIEW_NAV_CONTROL_STR"),c=h.get("SWE_DET_VIEW_NAV_CONTROL_STR"),d=h.get("SWE_DET_SUB_VIEW_NAV_CONTROL_STR");function a(){SiebelAppFacade.JSTreeRenderer.superclass.constructor.apply(this,arguments);var k={};this.GetDataSet=function(){return k};this.EmptyDataSet=function(){k={}};this.GetKey=function(){var m=h.get("SWE_PROP_NC_ID_SCREEN_CONTROL");var l=this.GetPM().Get("IsScreen")?"screenName":"viewName";this.GetKey=function(){return l};return l}}SiebelJS.Extend(a,SiebelAppFacade.BasePR);function j(o,l){var p="siebui-nav-tree",n=$("div#"+o+"."+p);if(l&&n.length===0){n=$('div[id="'+o+'"]');if(n.length){n=n.not(function(){return $(this).hasClass("siebui-nav-hb")});n=n.eq(0);var q=(n.attr("class")||"").split(" ");for(var m=0,k=q.length;m<k;m++){if(q[m].indexOf("siebui-nav-")===0&&q[m]!==p){n.removeClass(q[m])}}n.addClass(p)}}else{if(n.length){n=n.eq(0)}}return n}a.prototype.Init=function(){SiebelAppFacade.JSTreeRenderer.superclass.Init.apply(this,arguments);if(this.GetPM().Get("IsScreen")){this.AttachPMBinding("Refresh",this.BindData)}this.GetPM().AttachPMBinding("FocusNavLink",b,{scope:this})};a.prototype.ShowUI=function(){var l=this.GetPM();var k=SiebelApp.S_App.IsRwd()?l.Get("placeholder"):l.Get("GetType");var m=j.call(this,k,true);SiebelJS.Log("[JSTreeRenderer] -> jqcontainer = "+m.length);if(k===h.get("SWE_PROP_NC_ID_VIEW_CONTROL")){if((j.call(this,h.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL"),true)).length!==0){k=h.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")}}l.SetProperty("LevelPlaceholder",k);e.call(this,m)};function e(n){var m=this;if(n.length===1){n.dynatree({autoCollapse:true,imagePath:" ",classNames:{nodeIcon:null},clickFolderMode:3,minExpandLevel:1,persist:false,expandOnAdd:true,onPostInit:function(p,o){this.reactivate()},onClick:function(r,q){var t;var o=m.GetPM();if(r&&r.getEventTargetType(q)==="title"&&r.data.key){var u;if(r.data.isFolder===true){if(m.GetDataSet()!==null){t=m.GetDataSet()[r.data.key];u=t[o.Get("IsScreen")?"defaultViewName":m.GetKey()];t.viewName=u;if(o.Get("GetType")===h.get("SWE_PROP_NC_ID_SCREEN_CONTROL")){t.level=f}else{t.level=c}}}else{var p=o.Get("GetSelectedTabKey");var s=null;if(p!==null&&p!==undefined){t=o.Get("GetTabInfo")[p]}u=t.links[r.data.key].viewName;t.viewName=u;if(o.Get("GetType")===h.get("SWE_PROP_NC_ID_SCREEN_CONTROL")){t.level=g}else{t.level=d}}if(!o.OnControlEvent("OnClick",t)){return false}return true}else{return false}}});var l=m.GetPM();var k=(l.Get("GetType")===h.get("SWE_PROP_NC_ID_SCREEN_CONTROL"))?"siebui-view-navs":"siebui-subview-navs";if(!n.hasClass(k)){n.addClass(k)}this.TreeLoaded=true}}a.prototype.BindEvents=function(){var k=this;$(window).resize(function(){if(k.TreeLoaded){k.Refresh(true)}})};a.prototype.BindData=function(){var l=this.GetPM();var s=l.Get("GetDataReload");var k=l.Get("GetTabInfo");var q=l.Get("GetSelectedTabLinkInfo");var r;var o;if(s){this.EmptyDataSet()}var n=this.GetDataSet();var m={};if(k!==null&&(s)){for(o in k){if(k.hasOwnProperty(o)){if(o.search("tabScreen")===-1){continue}r=k[o];n[r[this.GetKey()]]=r}}}var p=l.Get("GetSelectedTabKey");var v=null;if(p!==null&&p!==undefined&&k[p]!==undefined){v=k[p][this.GetKey()]}var t=false;if(q!==null&&n[v]!==undefined&&n[v].links===undefined){var u=false;for(o in q){if(q.hasOwnProperty(o)){if(o.search("tabView")===-1){continue}r=q[o];m[r.viewName]=r;u=true}}if(u){n[v].links=m;t=true}}if(s){t=true}this.Refresh(t)};a.prototype.Refresh=function(M){if(!M){return}var r=this.GetPM();var N=j.call(this,SiebelApp.S_App.IsRwd()?r.Get("placeholder"):r.Get("GetType"));if(N.dynatree("getRoot").length===0){return}N.dynatree("getRoot").removeChildren();var n=r.Get("GetTabInfo")||{};if(!n.tabScreen0){return}var I=r.Get("GetSelectedTabLinkInfo")||{};var o=N.dynatree("getRoot");var m;var x;var S;var A=true;if(r.Get("IsScreen")){m=o.addChild({title:"Screens",key:"AllScreens",addClass:"dynatree-root-tag",isFolder:true,expand:true,url:null})}else{m=o}var B=r.Get("GetSelectedTabKey");var V=null;V=(n[B]||n.tabScreen0)[this.GetKey()];V=String(V);var s=r.Get("GetSelectedLinkKey");var y=null;if(s!==null&&s!==undefined){y=I[s]?I[s].viewName:""}y=String(y);var q=(N.width())>(N.height())?1:0;var k=q?N.width():N.height();var p=45;var O=false;var E=SiebelApp.S_App.IsRwd()?"j_"+r.Get("placeholder"):"j_"+r.Get("GetType");var G=(r.Get("IsScreen"))?"siebui-nav-screenlist":"siebui-nav-viewlist";var v='<select id="'+E+'" class="'+G+'"><option></option>';var U=false;var R=(r.Get("GetTabInfo")[r.Get("GetSelectedTabKey")]||r.Get("GetTabInfo")["tabScreen0"]);var w=null;w=m.addChild({title:R.captionName,isFolder:true,url:R.captionName,icon:R.tabIcon,activate:(R.captionName===V),addClass:(R.captionName===V)?"screen-tab-selected":"screen-tab-deselected",expand:R.captionName===V,key:R});var D=$($(w)[0].li).outerWidth(true);p+=D;m.removeChildren();$("#"+E).remove();var z=0;var P=0;var T=this.GetDataSet();for(var W in T){if(T.hasOwnProperty(W)){if(!O){x=m.addChild({title:T[W].captionName,isFolder:true,url:T[W].captionName,icon:T[W].tabIcon,activate:(W===V),addClass:(W===V)?"screen-tab-selected":"screen-tab-deselected",expand:W===V,key:W});if(W===V){U=true;p-=D}var J=this.GetDataSet()[W].links;var l=x;for(S in J){if(J.hasOwnProperty(S)){if(A&&r.Get("LevelPlaceholder")===h.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")){var F=j.call(this,r.Get("LevelPlaceholder"));e.call(this,F);if(F.dynatree("getRoot").length===0){return}F.dynatree("getRoot").removeChildren();l=F.dynatree("getRoot");A=false}var H=l.addChild({title:J[S].captionName,isFolder:false,url:J[S].captionName,activate:S===y,addClass:(r.Get("LevelPlaceholder")===h.get("SWE_PROP_NC_ID_SUB_VIEW_CONTROL")?((S===y)?"screen-tab-selected":"screen-tab-deselected"):((S===y)?"view-tab-selected":"view-tab-deselected")),key:S})}}var C=q?$($(x)[0].li).outerWidth(true):$($(x)[0].li).outerHeight(true);if((p+C)<=k){p+=C}else{if(q){O=true;x.remove();v+="<option value = "+(this.GetDataSet()[W].captionName)+">"+(this.GetDataSet()[W].captionName)+"</option>";P++}}}else{v+="<option value = "+(this.GetDataSet()[W].captionName)+">"+(this.GetDataSet()[W].captionName)+"</option>";P++}z++}}if(O){v+="</select>";N.append(v);var u=this.GetDataSet()[V].captionName;$("#"+E).find("option").each(function(){if(String(u)===$(this).text()){$(this).remove()}})}if(!U){var t=(r.Get("IsScreen"))?String(R.screenName):String(R.viewName);x=m.addChild({title:R.captionName,isFolder:true,url:R.captionName,icon:R.tabIcon,activate:(t===V),addClass:(t===V)?"screen-tab-selected":"screen-tab-deselected",expand:t===V,key:t});for(S in R.links){if(R.links.hasOwnProperty(S)){var K=x.addChild({title:R.links[S].captionName,isFolder:false,url:R.links[S].captionName,activate:S===y,key:S})}}}var L=this;
$("#"+E).change(function(){var Z=$("#"+E).find("option:selected").text();var X=L.GetDataSet();var aa="";for(var Y in X){if(X.hasOwnProperty(Y)){if(Z===String(X[Y].captionName)){aa=X[Y].viewName;X[Y]["level"]=c;if(!aa){X[Y]["viewName"]=X[Y].defaultViewName}r.OnControlEvent("OnClick",X[Y])}}}});var Q={};Q.comboContainer=E;Q.chtotal=z;Q.count=P;Q.overflow=O;i.call(this,m,Q)};function i(u,v){var z=this.GetPM();var o=z.Get("GetTabContainerQTPInfo");var k=z.Get("GetTabItemsQTPInfo");var r=z.Get("IsScreen")?(z.Get("GetTabInfo")[z.Get("GetSelectedTabKey")]&&z.Get("GetTabInfo")[z.Get("GetSelectedTabKey")].screenName):(z.Get("GetTabInfo")[z.Get("GetSelectedTabKey")]&&z.Get("GetTabInfo")[z.Get("GetSelectedTabKey")].viewName);var l=z.Get("GetTabViewLinkContainerQTPInfo");var A=z.Get("GetTabViewLinkItemsQTPInfo");var B=h.get("SWE_PROP_QTP_OT");var m=h.get("SWE_PROP_QTP_RN");var n=h.get("SWE_PROP_QTP_UN");if(o&&(typeof(o.GetProperty)==="function")){u.ul.setAttribute("ot",o.GetProperty(B));u.ul.setAttribute("rn",o.GetProperty(m));u.ul.setAttribute("un",o.GetProperty(n))}var y=u.getChildren()?u.getChildren().length:0;for(var x=0;x<y;x++){var q=u.getChildren()[x];if(k[x]&&(typeof(k[x].GetProperty)==="function")){q.li.setAttribute("ot",k[x].GetProperty(B));q.li.setAttribute("rn",k[x].GetProperty(m));q.li.setAttribute("un",k[x].GetProperty(n))}if((q.getChildren()!==null)&&(r===q.data.key)){if(l&&(typeof(l.GetProperty)==="function")){q.ul.setAttribute("ot",l.GetProperty(B));q.ul.setAttribute("rn",l.GetProperty(m));q.ul.setAttribute("un",l.GetProperty(n))}for(var w=0;w<q.getChildren().length;w++){var t=q.getChildren()[w];if(A[w]&&(typeof(A[w].GetProperty)==="function")){t.li.setAttribute("ot",A[w].GetProperty(B));t.li.setAttribute("rn",A[w].GetProperty(m));t.li.setAttribute("un",A[w].GetProperty(n))}}}}if(!v.overflow){return}var u=$("#"+v.comboContainer);var s=z.Get("GetJumpTabQTPInfo");var B=h.get("SWE_PROP_QTP_OT");var m=h.get("SWE_PROP_QTP_RN");var n=h.get("SWE_PROP_QTP_UN");var p=v.chtotal-v.count;if(s&&(typeof(s.GetProperty)==="function")){u.attr("ot",s.GetProperty(B));u.attr("rn",s.GetProperty(m));u.attr("un",s.GetProperty(n))}q=u.children("option");var w=1;for(x=p;x<v.chtotal&&q.length>0;x++){if(k[x]&&(typeof(k[x].GetProperty)==="function")){q.eq(w).attr("ot",k[x].GetProperty(B));q.eq(w).attr("rn",k[x].GetProperty(m));q.eq(w).attr("un",k[x].GetProperty(n));w++}}}function b(n){var m=h.get("SWE_PROP_NC_ID_SCREEN_CONTROL");var l=h.get("SWE_PROP_NC_ID_VIEW_CONTROL");var k=null;switch(n){case f:k=j.call(this,m);if(k.dynatree("getRoot")){k.find(" ul  li a").eq(1).focus()}else{k.find(" ul  li a").eq(0).focus()}break;case c:k=j.call(this,l);k.find(" ul  li a").eq(0).focus();break}}return a}());return"SiebelAppFacade.JSTreeRenderer"})};