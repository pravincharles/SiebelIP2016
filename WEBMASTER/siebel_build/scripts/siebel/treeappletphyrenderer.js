/*<ORACLECOPYRIGHT>
* Copyright (C) 1994-2014
* Oracle and Java are registered trademarks of Oracle and/or its affiliates.
* Other names may be trademarks of their respective owners.
* UNIX is a registered trademark of The Open Group.
*
* This software and related documentation are provided under a license agreement
* containing restrictions on use and disclosure and are protected by intellectual property laws.
* Except as expressly permitted in your license agreement or allowed by law, you may not use, copy,
* reproduce, translate, broadcast, modify, license, transmit, distribute, exhibit, perform, publish,
* or display any part, in any form, or by any means. Reverse engineering, disassembly,
* or decompilation of this software, unless required by law for interoperability, is prohibited.
*
* The information contained herein is subject to change without notice and is not warranted to be error-free.
* If you find any errors, please report them to us in writing.
*
* U.S. GOVERNMENT RIGHTS Programs, software, databases, and related documentation and technical data delivered to U.S.
* Government customers are "commercial computer software" or "commercial technical data" pursuant to the applicable
* Federal Acquisition Regulation and agency-specific supplemental regulations.
* As such, the use, duplication, disclosure, modification, and adaptation shall be subject to the restrictions and
* license terms set forth in the applicable Government contract, and, to the extent applicable by the terms of the
* Government contract, the additional rights set forth in FAR 52.227-19, Commercial Computer Software License
* (December 2007). Oracle America, Inc., 500 Oracle Parkway, Redwood City, CA 94065.
*
* This software or hardware is developed for general use in a variety of information management applications.
* It is not developed or intended for use in any inherently dangerous applications, including applications that
* may create a risk of personal injury. If you use this software or hardware in dangerous applications,
* then you shall be responsible to take all appropriate fail-safe, backup, redundancy,
* and other measures to ensure its safe use. Oracle Corporation and its affiliates disclaim any liability for any
* damages caused by use of this software or hardware in dangerous applications.
*
* This software or hardware and documentation may provide access to or information on content,
* products, and services from third parties. Oracle Corporation and its affiliates are not responsible for and
* expressly disclaim all warranties of any kind with respect to third-party content, products, and services.
* Oracle Corporation and its affiliates will not be responsible for any loss, costs,
* or damages incurred due to your access to or use of third-party content, products, or services.
</ORACLECOPYRIGHT>*/
/* 8.1.1.14SIA[23044]PATCHSET12 */
if(typeof(SiebelAppFacade.TreeAppletPR)==="undefined"){SiebelJS.Namespace("SiebelAppFacade.TreeAppletPR");define("siebel/treeappletphyrenderer",["3rdParty/jstree/jquery.jstree.js","3rdParty/accessible-jqui/jquery.hotkeys.js","siebel/basephyrenderer"],function(){SiebelAppFacade.TreeAppletPR=(function(){var j=SiebelJS.Dependency("SiebelApp.Utils");var g=SiebelJS.Dependency("SiebelApp.Constants");var e;function b(o){SiebelAppFacade.TreeAppletPR.superclass.constructor.call(this,o);var n=false;this.SetPending=function(r){n=r};this.IsPending=function(){return n};var p=false;this.SetReady=function(){p=true};this.IsReady=function(){return p};var q=false;this.SetLateBinding=function(r){q=r};this.IsLateBinding=function(){return q};this.SetDefaultIcon=function(r){e=r};this.GetDefaultIcon=function(){return e}}SiebelJS.Extend(b,SiebelAppFacade.BasePR);b.prototype.Init=function(){SiebelAppFacade.TreeAppletPR.superclass.Init.call(this);this.AttachPMBinding("refreshTree",this.BindData);this.AttachPMBinding("cleartree",c);this.AttachPMBinding("FocusSelectedTreeNode",function(o){var p=this.GetPM();var r=p.Get("placeholder");var n="ti_"+p.Get("selectednode").position;var q=$("#"+r).jstree("get_selected");$("#"+r).jstree("deselect_node",q);$("#"+r).jstree("select_node",n);n=n.replace(/\./gi,"\\.");$("#"+n).attr("role","presentation").attr("aria-selected","true").children("a").addClass("siebel-selectednode")})};b.prototype.EndLife=function(){$("#"+this.GetPM().Get("placeholder")).jstree("destroy")};b.prototype.ShowUI=function(){SiebelAppFacade.TreeAppletPR.superclass.ShowUI.call(this);var p=this.GetPM();var r=p.Get("placeholder");var n=p.Get("root");var q=$("#s_"+p.Get("GetFullId")+"_div");var o=SiebelApp.S_App.GetDirection();if(j.IsTrue(SiebelApp.S_App.GetAccessibilityEnhanced())){q.attr({role:"region",title:p.Get("LandMarkTitle")})}$("#"+r).bind("loaded.jstree",{ctx:this},function(u,t){var s=u.data.ctx;s.SetReady();f.call(s);if(s.IsPending()){s.SetPending(false);s.BindData()}});k.call(this);$("#"+r).jstree("clear_bindingflag");q.removeClass("siebui-form");q.addClass(" siebui-applet siebui-tree siebui-applet-title ");i.call(this)};function i(){var n=this.GetPM();var o=$("#s_"+n.Get("GetFullId")+"_div");if(o.length!=0){if(typeof(n.Get("GetObjectType"))==="string"){$(o).attr("ot",n.Get("GetObjectType"))}if(typeof(n.Get("GetRepstrName"))==="string"){$(o).attr("rn",n.Get("GetRepstrName"))}if(typeof(n.Get("GetUIName"))==="string"){$(o).attr("un",n.Get("GetUIName"))}}}b.prototype.BindEvents=function(){SiebelAppFacade.TreeAppletPR.superclass.BindEvents.call(this);var n=this.GetPM();var p=n.Get("placeholder");var o=this;$("#"+p).bind("reopen.jstree",function(s,r){if(n.Get("selectednode")){var q="ti_"+n.Get("selectednode").position.replace(/\./gi,"\\.");$("#"+p).jstree("select_node",q)}});$("#"+p).bind("close_node.jstree",function(t,q){if(q.node){var s=q.node.id.split("ti_")[1];n.OnControlEvent("OnTreeEvent","CollapseTreeItem",s);var r=$("#"+q.node.id.replace(/\./gi,"\\."));r.children("a").attr("tabindex","0").focus()}});$("#"+p).bind("open_node.jstree",function(u,s){if(s.node){var v=s.node.id.split("ti_")[1],q,r;if(o.IsLateBinding()){q=n.Get("root");r=l.call(o,s.node.id,q);if(r){r.expand="t";a.call(o,r,p)}}n.OnControlEvent("OnTreeEvent","ExpandTreeItem",v);var t=$("#"+s.node.id.replace(/\./gi,"\\."));t.children("a").attr("tabindex","0").focus()}});$("#"+p).bind("hover_node.jstree",function(s,q){var r=$("#"+q.node.id.replace(/\./gi,"\\."));r.removeAttr("aria-selected");if(!r||!r.length){return false}r.children("a").attr("tabindex","0").focus()});$("#"+p).bind("dehover_node.jstree",function(s,q){var r=$("#"+q.node.id.replace(/\./gi,"\\."));r.removeAttr("aria-selected");if(!r||!r.length){return false}r.children("a").attr("tabindex","-1")});$("#"+p).bind("click",function(s,t){s.stopImmediatePropagation();if(s.target.nodeName==="A"){n.ExecuteMethod("SetCurrentNode",$(s.target).parent("li")[0].id.split("ti_")[1]);var r=n.Get("currentnode").type;var q="";if(r===g.get("TREENODE_TYPE_NEXT")){q="NextTreeItem"}else{if(r===g.get("TREENODE_TYPE_PREV")){q="PreviousTreeItem"}else{q="SelectTreeItem"}}var u=$(s.target).parent("li")[0].id.split("ti_")[1];n.OnControlEvent("OnTreeEvent",q,u)}})};function l(q,n){var p=null;if("ti_"+n.position===q){return n}for(var o=0;o<n.child.length;o++){if("ti_"+n.child[o].position===q){return n.child[o]}}for(var o=0;o<n.child.length;o++){if(n.child[o].child.length>0){p=l.call(this,q,n.child[o]);if(p!=null){return p}}}return null}function m(n,o){var q=l.call(this,"ti_"+n,o);var p;if(q==null){return null}while(q.parent&&"ti_"+q.parent.position!="ti_0"){p=q.parent;p.expand="t";q=q.parent}return p}function c(){var r=this.GetPM();var o=r.Get("root");SiebelJS.Log((new Date()).toLocaleString()+": Tree:Cleartree:begin");if(o&&o.child){for(var q=0;q<=o.child.length-1;q++){var n=o.child[q];d.call(this,n)}}try{var s=$("#"+this.GetPM().Get("placeholder")).jstree("data");s.data.html_data.original_container_html=null;s.data.ui.selected=$();s.data.ui.last_selected=false;s.data.ui.hovered=null;s.data.ui.to_select=[]}catch(p){SiebelJS.Log("Exception while clearing tree ")}SiebelJS.Log((new Date()).toLocaleString()+": Tree:Cleartree:end")}function d(o){var q=this.GetPM();var n=o.child;var s=q.Get("placeholder");for(var p=0;p<=n.length-1;p++){var r="ti_"+n[p].position;$("#"+s).jstree("delete_node",r)}$("#"+s).jstree("deselect_node","ti_1")}b.prototype.BindData=function(){SiebelAppFacade.TreeAppletPR.superclass.BindData.call(this);if(!this.IsReady()){this.SetPending(true);return}SiebelJS.Log((new Date()).toLocaleString()+": Tree:BindData:begin");var n=this.GetPM();var u=n.Get("root");var t=n.Get("placeholder");var q=n.Get("nodecount");if(q>200){this.SetLateBinding(true)}else{this.SetLateBinding(false)}if(u&&u.child){var v;var p;if($("#"+t).find("li").length===0){k.call(this,false)}$("#"+t).jstree("rename_node","#ti_"+u.child[0].position,u.child[0].caption);for(var o=0;o<=u.child.length-1;o++){var s=u.child[o];a.call(this,s,t);var r="ti_"+s.position.replace(/\./gi,"\\.");$("div#"+t+" ul li#"+r).children("a").attr("aria-expanded",(!j.IsEmpty(s.expand)&&s.expand==="t"))}v="ti_"+n.Get("selectednode").position;p=m.call(this,n.Get("selectednode").position,u);if(this.IsLateBinding()&&p){a.call(this,p,t)}$("#"+t).find("i").each(function(){$(this).attr({role:"presentation","aria-hidden":"true"})});$("#"+t).find("ul").each(function(){$(this).attr("role","group")});$("#"+t).jstree("select_node",v);v=v.replace(/\./gi,"\\.");$("#"+v).attr("role","presentation").children("a").attr("aria-selected","true").addClass("siebel-selectednode").attr("tabindex","0");if(n.Get("IsActive")){$("#"+v).children("a").focus()}}else{$("#"+t).jstree("delete_node","#ti_0")}if(this.GetDefaultIcon()){$($("#"+t).find("a").find("i")[0]).css("background-image","url("+this.GetDefaultIcon()+")").css("background-position","0 , 0")}SiebelJS.Log((new Date()).toLocaleString()+": Tree:BindData:end")};function k(){var r=this.GetPM();var s=r.Get("placeholder");
var o=r.Get("nodeIconsMap");var p=r.Get("root");var q=SiebelApp.S_App.GetDirection();$("#"+s).jstree("destroy");if(p&&p.child){if(p.child.length>0){var t=o.GetProperty(p.child[0].caption);this.SetDefaultIcon(t?$(t).find("img").addBack("img").attr("src"):"");t=null}}var n=$("#"+s);n.jstree({core:{data:{id:"ti_0",state:{opened:true},},rtl:(q?true:false),themes:{url:true,dir:SIEBEL_BUILD+"3rdParty/jstree/themes",name:"default",icons:true,dots:true},check_callback:true},plugins:["ui","themes","html_data","hotkeys","crrm"]})}function f(){var p=this.GetPM(),t=p.Get("placeholder"),q=p.Get("nodeIconsMap"),v=p.Get("root"),o=SiebelApp.S_App.GetDirection(),u=$("#"+t);if(v&&v.child){for(var r=0;r<=v.child.length-1;r++){var s=v.child[r];var n=(s.expand&&s.expand.toLowerCase()==="t")?true:false;u.jstree("create_node","ti_0",{id:"ti_"+s.position,text:s.caption,state:{opened:n},li_attr:{name:s.position,role:"presentation"},a_attr:{role:"treeitem",tabindex:"-1","aria-expanded":n},},"last","",true)}}$("#ti_0>i").addClass("siebui-no-display");$("#ti_0>a").addClass("siebui-no-display")}function h(o,n){var p=n.match(/siebel\-icon[^\s]+/g)||[];return(p.join(" "))}function a(z,s){var p=(z.expand&&z.expand.toLowerCase()==="t")?true:false,E=(this.IsLateBinding()&&!p),u={id:"ti_"+z.position,state:{opened:p}},D=this.GetPM(),x=D.Get("nodeIconsMap"),o=x.GetPropertyCount(),C=$("#"+s);tinode=$("#"+s).jstree("get_node",u);if(tinode){tinode.state.opened=p}for(var B=0;B<=z.child.length-1;B++){if(B>0&&E){break}var t=z.child[B],r="#ti_"+t.position.replace(/\./gi,"\\.");if($(r).length>0){continue}var v=x.GetProperty(t.caption),A="",y=(t.expand&&t.expand.toLowerCase()==="t")?true:false;if(o>0&&v){A=$(v).find("img").addBack("img").attr("src")}else{if(this.GetDefaultIcon()){A=this.GetDefaultIcon()}}var q="";if(!j.IsEmpty(t.icon)){q="siebel-icon-"+t.icon}C.jstree("create_node",u,{id:"ti_"+t.position,text:t.caption,state:{opened:y},icon:A,li_attr:{name:t.position,role:"presentation","class":q},a_attr:{role:"treeitem",tabindex:"-1","aria-expanded":y}},"last","",true);if(t.type===g.get("TREENODE_TYPE_NEXT")){var w="#ti_"+t.position.replace(/\./gi,"\\.");$(w).addClass("siebel-nextpage")}else{if(t.type===g.get("TREENODE_TYPE_PREV")){var F="#ti_"+t.position.replace(/\./gi,"\\.");$(F).addClass("siebel-prevpage")}}if(t.child.length>0){a.call(this,t,s)}else{$(r).removeClass("jstree-open").addClass("jstree-leaf");$(r).removeClass("jstree-open").addClass("jstree-leaf")}}if(j.IsEmpty(z.expand)){var n=z.position.replace(/\./gi,"\\.");$("div#"+s+" ul li[id="+n+"]").removeClass("jstree-open").addClass("jstree-closed").children("a").attr("aria-expanded","false")}}b.prototype.ShowSelection=function(){};b.prototype.SetHighlightState=function(){};b.prototype.FocusFirstControl=function(){};b.prototype.UpdateUIButtons=function(){};return b}());return"SiebelAppFacade.TreeAppletPR"})};